"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[3224,886],{90886:function(e,t,s){s.d(t,{f:function(){return o},h:function(){return a}});s(57658);function a(e,t=[],s={name:"code_name",value:"code_value"}){if(!e)return e;if(0===t.length)return e;if(!Object.hasOwn(t[0],"code_name")&&"code_name"===s.name)return e;if(e=e.toString(),e.includes(",")){let a=[];for(let o of e.split(","))a.push(t.find((e=>e[s.value]===o)));return a.map((e=>e[s.name])).join(",")}{const a=t.find((t=>t[s.value]===e));return a?a[s.name]:e}}function o(e){if(isNaN(e))return e;e=parseFloat(e),e=e.toFixed(2);const t=/\B(?=(\d{3})+(?!\d))/g;return e.replace(t,",")}},8398:function(e,t,s){s.d(t,{Z:function(){return u}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"flex flex-items-center"},[t(e.animatLable?"clw-select":"el-select",{tag:"component",attrs:{filterable:"","allow-create":e.allowCreate,"default-first-option":"",clearable:"","collapse-tags":"",size:e.size,disabled:e.disabled,multiple:e.multiple,placeholder:e.placeholder},on:{"visible-change":e.visibleChange,input:e.input,change:e.change},model:{value:e.warehouse,callback:function(t){e.warehouse=t},expression:"warehouse"}},e._l(e.warehouses,(function(e,s){return t("el-option",{key:s,attrs:{label:e,value:e}})})),1),e.showSelectAll?t("el-button",{attrs:{type:"text"},on:{click:e.selectAll}},[e._v("全选")]):e._e()],1)},o=[],r=s(5376),l={name:"client-select",components:{"clw-select":()=>Promise.all([s.e(1377),s.e(3131)]).then(s.bind(s,71377))},props:{animatLable:{type:Boolean,default:!1},value:{type:[String,Array]},size:{type:String,default:"medium"},params:{type:Object,default(){return{}}},showSelectAll:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},allowCreate:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},placeholder:{type:String,default:"平台客户"}},watch:{value:{immediate:!0,handler(e,t){"object"===typeof e&&e.length>0&&0===this.warehouses.length&&this.getData(),"string"===typeof e&&""!==e&&0===this.warehouses.length&&this.getData(),this.warehouse=e}}},data(){return{warehouses:[],warehouse:null}},methods:{visibleChange(e){e&&this.getData()},getData(){(0,r.Jz)(this.params).then((e=>{0===e.code&&(this.warehouses=e.data)}))},input(e){this.$emit("input",e)},change(e){this.$emit("change",e)},selectAll(){const e=this.warehouses.map((e=>e.warehouseNo));this.$emit("input",e)}}},n=l,i=s(1001),c=(0,i.Z)(n,a,o,!1,null,"c7a85400",null),u=c.exports},63224:function(e,t,s){s.r(t),s.d(t,{default:function(){return h}});var a=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"停复运审批","close-on-click-modal":!1,"append-to-body":!0,visible:e.show,"before-close":e.close}},[t("div",{staticClass:"mb-4"},[t("div",{staticClass:"fs-6 fw-bold text-start"},[e._v("内容信息")]),t("el-descriptions",{attrs:{size:"small",border:""}},[t("el-descriptions-item",{attrs:{label:"电站编号"}},[e._v(e._s(e.info.stationNo))]),t("el-descriptions-item",{attrs:{label:"电站名称"}},[e._v(e._s(e.info.stationName))]),t("el-descriptions-item",{attrs:{label:"申请类别"}},[e._v(e._s(e._f("transfortext")(e.info.restoreType,e.dropdowns.restoreType)))]),t("el-descriptions-item",{attrs:{label:"申请原因"}},[e._v(e._s(e.info.reason))]),t("el-descriptions-item",{attrs:{label:"申请人"}},[e._v(e._s(e.info.updateBy))]),t("el-descriptions-item",{attrs:{label:"申请时间"}},[e._v(e._s(e.info.createTime))])],1)],1),t("process-info",{ref:"process-info",attrs:{params:e.params}}),e.$listeners.success?t("el-form",{ref:"ruleForm",staticClass:"mt-5",attrs:{model:e.form,rules:e.rules,"label-width":"90px"}},[t("el-form-item",{attrs:{label:"审批结果",prop:"status"}},[t("el-select",{attrs:{filterable:"","default-first-option":"",clearable:"",placeholder:""},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.dropdowns.status,(function(e,s){return t("el-option",{key:s,attrs:{label:e.code_name,value:e.code_value}})})),1)],1),t("el-form-item",{attrs:{label:"审批意见",prop:"comments"}},[t("el-input",{attrs:{clearable:"",placeholder:""},model:{value:e.form.comments,callback:function(t){e.$set(e.form,"comments",t)},expression:"form.comments"}})],1)],1):e._e(),t("span",{attrs:{slot:"footer"},slot:"footer"},[e.$listeners.success?[e.params.assignee?e._e():t("el-button",{attrs:{plain:"",type:"primary"},on:{click:e.entrust}},[e._v("委托办理")]),t("el-button",{attrs:{type:"primary"},on:{click:e.examine}},[e._v("审批")])]:e._e(),t("el-button",{on:{click:e.close}},[e._v("关闭")])],2)],1)},o=[],r=s(8398),l=s(83693),n=s(44693),i=s(5376),c=s(90886),u={name:"",filters:{transfortext:c.h},components:{"process-info":()=>Promise.all([s.e(9674),s.e(7815),s.e(4945),s.e(3699),s.e(5508),s.e(4461),s.e(5588),s.e(4291),s.e(7937),s.e(7504)]).then(s.bind(s,84841))},data(){return this.rules=m,{dropdowns:{status:[],restoreType:[]},info:{},form:{status:"",comments:""}}},props:{show:{type:Boolean,default:!1},params:{type:Object,required:!0}},watch:{show:{immediate:!0,handler(e,t){e&&(this.getDetailInfo(),this.getDropdowns())}}},methods:{getDropdowns(){(0,i.Wl)("426807").then((e=>{0===e.code&&(this.dropdowns.status=e.data)})),(0,i.Wl)("3001").then((e=>{0===e.code&&(this.dropdowns.restoreType=e.data)}))},getDetailInfo(){(0,l.tJ)({procInstId:this.params.processInstanceId}).then((e=>{0===e.code&&(this.info=e.data)}))},entrust(){const e=this.$createElement;let t="";this.$msgbox({title:"选择委托办理人",message:e("div",{key:new Date+""},[e(r.Z,{attrs:{key:this.params.taskId},on:{change:e=>{t=e}}})]),confirmButtonText:"确定",beforeClose:(e,s,a)=>{if("confirm"===e){if(!t)return void this.$message.error("请选择委托办理人");s.confirmButtonLoading=!0,s.confirmButtonText="执行中...",(0,n.Nx)({assignee:t,taskId:this.params.taskId}).then((e=>{0===e.code&&(a(),this.close(),this.$emit("success"),this.$message.success(e.msg))})).finally((()=>{s.confirmButtonLoading=!1}))}else a()}})},examine(){this.$refs["ruleForm"].validate((e=>{e&&(0,l.o5)({...this.form,procInstId:this.params.processInstanceId}).then((e=>{0===e.code&&(this.close(),this.$emit("success"),this.$message.success(e.msg))}))}))},close(){try{this.$refs["ruleForm"].resetFields()}catch(e){}this.$emit("close",!1)}}};const m={status:[{required:!0,message:"请选择审批结果",trigger:"change"}],comments:[{required:!0,message:"请输入审批意见",trigger:"blur"},{pattern:/^[^<|>|-|*|/|=|{|}]*$/,message:"禁止< > - * / = { }等特殊字符",trigger:"blur"}]};var d=u,p=s(1001),f=(0,p.Z)(d,a,o,!1,null,"936d1cde",null),h=f.exports}}]);