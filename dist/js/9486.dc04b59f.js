"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[9486],{59486:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var l=a(63598),o=a(90649),n=a(67539),r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"reconciliat"},[t(n.Z,{attrs:{loading:e.tableLoading,btnSpan:20,getData:e.getData,queryReset:e.queryReset}},[t("el-col",{attrs:{span:4}},[t(o.Z,{attrs:{size:"medium",type:"datetimerange",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"对账时间段","picker-options":e.pickerOptions},on:{change:e.selecTime},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}})],1)],1),t("el-divider"),t(l.Z,{ref:"table",attrs:{name:"财务统计",loading:e.tableLoading,total:e.total,data:e.tableData,height:"550","show-index":!0,"page-size":e.queryForm.pageSize,"current-page":e.queryForm.pageNum,derive:e.exporting},on:{"cell-click":e.tabClick,"size-change":e.dataSizeChange,"current-change":e.handleCurrentChange},scopedSlots:e._u([{key:"left",fn:function(){return[t("el-button",{attrs:{size:"small"},on:{click:function(t){e.totalDrawer=!0}}},[e._v("总计")])]},proxy:!0},{key:"columns",fn:function(){return[t("el-table-column",{attrs:{prop:"days",label:"日期",width:"110",fixed:"left"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"yesBalMoney",label:"上期余额",sortable:"",width:"120"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("span",[e._v("上期余额")])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"todayBalMoney",label:"本期余额",sortable:"",width:"120"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("span",[e._v("本期余额")])]}}])}),t("el-table-column",{attrs:{width:"150",prop:"WeiXinPay",label:"①支付结算金额",sortable:"","class-name":"can-click-cell"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("span",{attrs:{title:"支付平台中的支付记录金额合计（包含充值、付款记录）"}},[e._v(" ①支付结算金额 ")])]}}])}),t("el-table-column",{attrs:{width:"150",prop:"chongZhiMoney",label:"②其中充值金额",sortable:"","class-name":"can-click-cell"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("span",{attrs:{title:"支付记录中的充值金额合计"}},[e._v("②其中充值金额")])]}}])}),t("el-table-column",{attrs:{width:"160",prop:"useBalanceMoney",label:"③其中消费充值金",sortable:"","class-name":"can-click-cell"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("span",{attrs:{title:"预存扣款支付金额"}},[e._v("③其中消费充值金")])]}}])}),t("el-table-column",{attrs:{prop:"refundBalMoney",label:"④预存退款",sortable:"","class-name":"can-click-cell",width:"120"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("span",[e._v("④预存退款")])]}}])}),t("el-table-column",{attrs:{width:"160",prop:"refundMoney",label:"⑤退款结算总金额",sortable:"","class-name":"can-click-cell"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("span",{attrs:{title:"支付平台中的退款记录金额合计"}},[e._v("⑤退款结算总金额")])]}}])}),t("el-table-column",{attrs:{width:"160",prop:"userTiXian",label:"⑥用户提现总金额",sortable:"","class-name":"can-click-cell"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("span",{attrs:{title:"支付平台中的用户提现记录金额合计"}},[e._v("⑥用户提现总金额")])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",width:"110",prop:"feeMoney",label:"⑦手续费",sortable:""},scopedSlots:e._u([{key:"header",fn:function(a){return[t("span",{attrs:{title:"支付平台中的支付记录手续费合计（包含充值、付款记录手续费）"}},[e._v(" ⑦手续费 ")])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",width:"120",prop:"ruZhangMoney",label:"⑧微信净额",sortable:""},scopedSlots:e._u([{key:"header",fn:function(a){return[t("el-tooltip",{attrs:{effect:"dark",content:"①-⑤-⑥-⑦",placement:"top"}},[t("span",{attrs:{title:"实际用户消费金额合计（含预存扣款支付金额、微信直接付款金额，本表公式为）"}},[e._v(" ⑧微信净额 ")])])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",width:"120",prop:"tiXianMoney",label:"⑨提现金额",sortable:""},scopedSlots:e._u([{key:"header",fn:function(a){return[t("el-tooltip",{attrs:{effect:"dark",content:"①-②+③-⑤-⑦",placement:"top"}},[t("span",{attrs:{title:"实际用户消费金额合计（含预存扣款支付金额、微信直接付款金额，本表公式为）"}},[e._v(" ⑨提现金额 ")])])]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"zuoZhangMoney",label:"⑩做账金额",sortable:"",fixed:"right"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("el-tooltip",{attrs:{effect:"dark",content:"①-②+③-⑤",placement:"top"}},[t("span",[e._v("⑩做账金额")])])]}}])})]},proxy:!0}])}),t("el-drawer",{attrs:{modal:!1,"append-to-body":!0,"modal-append-to-body":!1,"with-header":!1,"before-close":e.handleClose,visible:e.totalDrawer}},[t("el-descriptions",{staticClass:"m-5",attrs:{title:"数据总览",column:1,border:""}},[t("el-button",{attrs:{slot:"extra",plain:"",type:"primary",size:"small"},on:{click:e.exportTotal},slot:"extra"},[e._v("导出")]),e._l(e.totalData,(function(a,l){return t("el-descriptions-item",{key:l,attrs:{label:a.name}},[e._v(" "+e._s(a.value)+" ")])}))],2)],1)],1)},s=[],i=a(25335),c=a(30741),u={name:"",mixins:[c.LI,c.I_,c.oA,c.vd],data(){return{pickerOptions:{disabledDate(e){return e.getTime()>Date.now()}},tableLoading:!1,time:"",dropdowns:{refundStatus:[]},queryForm:{pageNum:1,pageSize:31,beginTime:"",endTime:""},tableData:[],totalData:[],total:0,totalDrawer:!1}},created(){this.queryForm.pageSize=this.getNowDays()},methods:{getNowDays(){const e=new Date,t=e.getFullYear(),a=e.getMonth()+1;let l=new Date(t,a,0);return l.getDate()},tabClick(e,t,a,l){"useBalanceMoney"===t.property?this.$emit("change-tab",{name:"deductions"},{payTime:e.days}):["chongZhiMoney","WeiXinPay","refundMoney","userTiXian"].includes(t.property)&&this.$emit("change-tab",{name:"orders"},{payTime:e.days,type:t.property})},selecTime(e){e?(this.queryForm.beginTime=e[0],this.queryForm.endTime=e[1]):(this.queryForm.beginTime="",this.queryForm.endTime="")},getData(){this.getTotal(),this.getStatData()},getStatData(){this.tableLoading=!0,this.tableData=[],(0,i.gh)(this.queryForm).then((e=>{this.tableLoading=!1,0===e.code&&(this.tableData=e.rows,this.total=e.total)})).catch((()=>{this.tableLoading=!1}))},getTotal(){(0,i.zX)(this.queryForm).then((e=>{0===e.code&&(this.totalData=[{name:"上期余额",value:e.rows[0].yesBalAllMoney+"元"},{name:"本期余额",value:e.rows[0].todayBalAllMoney+"元"},{name:"收款金额",value:e.rows[0].WeiXinAllPay+"元"},{name:"充值金额",value:e.rows[0].chongZhiAllMoney+"元"},{name:"扣款金额",value:e.rows[0].useBalanceAllMoney+"元"},{name:"订单退款",value:e.rows[0].refundAllMoney+"元"},{name:"用户提现",value:e.rows[0].userTiXianAll+"元"},{name:"手续费",value:e.rows[0].feeAllMoney+"元"},{name:"微信净额",value:e.rows[0].ruZhangAllMoney+"元"},{name:"公司提现",value:e.rows[0].tiXianAllMoney+"元"},{name:"入账金额",value:e.rows[0].zuoZhangAllMoney+"元"}])}))},handleClose(e){this.totalDrawer=!1},async exporting(e){let t={...this.queryForm};"2"===e&&(t.pageSize=this.total,t.pageNum=1);const a=await(0,i.gh)(t);if(0===a.code){const e=this.$refs.table.getColumns(),t=a.rows.map((t=>{let a=e.map((e=>[e.label,t[e.prop]]));return Object.fromEntries(a)}));return t}},exportTotal(){const e=this.totalData.map((e=>({"名目":e.name,"数据":e.value})));this.$refs.table.exportExcel(e)}}},p=u,d=a(1001),m=(0,d.Z)(p,r,s,!1,null,"87ee832a",null),h=m.exports}}]);