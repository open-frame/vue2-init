"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[500],{40500:function(e,t,r){r.r(t),r.d(t,{default:function(){return y}});var a=r(63598),o=r(75267),l=r(1985),s=r(67539),i=function(){var e=this,t=e._self._c;return t("el-card",{},[t(s.Z,{attrs:{loading:e.tableLoading,btnSpan:16,getData:e.getData,queryReset:e.queryReset}},[t("el-col",{attrs:{span:4}},[t(l.Z,{attrs:{animatLable:""},on:{change:e.pageReset},model:{value:e.queryForm.deptCode,callback:function(t){e.$set(e.queryForm,"deptCode",t)},expression:"queryForm.deptCode"}})],1),t("el-col",{attrs:{span:4}},[t(o.Z,{attrs:{clearable:"",size:"medium",placeholder:"用户手机号"},on:{change:e.pageReset},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData.apply(null,arguments)}},model:{value:e.queryForm.phoneNumber,callback:function(t){e.$set(e.queryForm,"phoneNumber",t)},expression:"queryForm.phoneNumber"}})],1)],1),t("el-divider"),t(a.Z,{ref:"table",attrs:{loading:e.tableLoading,total:e.total,data:e.tableData,height:"560","page-size":e.queryForm.pageSize,"current-page":e.queryForm.pageNum},on:{"size-change":e.dataSizeChange,"current-change":e.handleCurrentChange},scopedSlots:e._u([{key:"columns",fn:function(){return[t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"deptName",label:"组织名称"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"deptCode",label:"组织编号"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"leader",label:"负责人"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"phone",label:"手机号",width:"120"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"email",label:"邮箱"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"amount",label:"绑定用户状态"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"userName",label:"绑定用户"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"phonenumber",label:"绑定用户手机",width:"180"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"balance",label:"账户余额"}}),t("el-table-column",{attrs:{label:"操作",width:"160",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{plain:"",type:"primary",size:"mini"},on:{click:function(t){return e.openBindUserDialog(r.row)}}},[e._v("绑定")]),t("el-button",{attrs:{plain:"",size:"mini"},on:{click:function(t){return e.openRechargeDialog(r.row)}}},[e._v("充值")])]}}])})]},proxy:!0}])}),t("el-dialog",{attrs:{"close-on-click-modal":!1,title:"关联法人与企业","append-to-body":!0,"modal-append-to-body":!1,visible:e.bindUserDialog,"before-close":e.closeBindUserDialog}},[e.bindUserForm.id?t("div",{staticClass:"mt-5",staticStyle:{width:"330px",margin:"0 auto"}},[t("div",{staticClass:"item"},[t("span",{staticClass:"text-end text-warmgray"},[e._v("昵称：")]),t("span",[e._v(e._s(e.bindUserForm.user_name))])]),t("div",{staticClass:"item"},[t("span",{staticClass:"text-end text-warmgray"},[e._v("账号：")]),t("span",[e._v(" "+e._s(e.bindUserForm.user_id))])]),t("div",{staticClass:"item"},[t("span",{staticClass:"text-end text-warmgray"},[e._v("积分：")]),t("span",[e._v(e._s(e.bindUserForm.integral))])]),t("div",{staticClass:"item"},[t("span",{staticClass:"text-end text-warmgray"},[e._v("电话号码：")]),t("span",[e._v(e._s(e.bindUserForm.phonenumber))])]),t("div",{staticClass:"item"},[t("span",{staticClass:"text-end text-warmgray"},[e._v("余额：")]),t("span",[e._v(e._s(e.bindUserForm.balance))])])]):e._e(),t("span",{attrs:{slot:"footer"},slot:"footer"},[e.bindUserForm.id?t("el-button",{attrs:{type:"primary"},on:{click:e.bindUser}},[e._v("绑定")]):e._e(),t("el-button",{on:{click:e.closeBindUserDialog}},[e._v("关闭")])],1)]),t("el-dialog",{attrs:{"close-on-click-modal":!1,title:"企业充值","append-to-body":!0,"modal-append-to-body":!1,visible:e.rechargeDialog,"before-close":e.closeRechargeDialog}},[t("el-form",{ref:"rechargeFrom",attrs:{model:e.rechargeFrom,rules:e.rechargeFromRules,"label-width":"110px"}},[t("el-form-item",{attrs:{label:"支付金额",prop:"amount"}},[t("el-input",{attrs:{type:"number",clearable:""},model:{value:e.rechargeFrom.amount,callback:function(t){e.$set(e.rechargeFrom,"amount",t)},expression:"rechargeFrom.amount"}})],1),t("el-form-item",{attrs:{label:"支付时间",prop:"payTime"}},[t("el-date-picker",{attrs:{"picker-options":e.pickerOptions,type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.rechargeFrom.payTime,callback:function(t){e.$set(e.rechargeFrom,"payTime",t)},expression:"rechargeFrom.payTime"}})],1),t("el-form-item",{attrs:{label:"交易流水号",prop:"orderId"}},[t("el-input",{attrs:{clearable:""},model:{value:e.rechargeFrom.orderId,callback:function(t){e.$set(e.rechargeFrom,"orderId",t)},expression:"rechargeFrom.orderId"}})],1),t("el-form-item",{attrs:{label:"支付方式",prop:"payMode"}},[t("el-select",{attrs:{filterable:"","default-first-option":"",placeholder:""},model:{value:e.rechargeFrom.payMode,callback:function(t){e.$set(e.rechargeFrom,"payMode",t)},expression:"rechargeFrom.payMode"}},e._l(e.dropdowns.payMode,(function(e,r){return t("el-option",{key:r,attrs:{label:e.code_name,value:e.code_value}})})),1)],1)],1),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:e.recharge}},[e._v("充值")]),t("el-button",{on:{click:e.closeRechargeDialog}},[e._v("关闭")])],1)],1)],1)},n=[],d=r(97589),c=r(5376),p=r(30741),m={name:"company-user-company-recharge-index",mixins:[p.LI,p.I_,p.oA,p.vd],data(){return{pickerOptions:{disabledDate(e){return e.getTime()>Date.now()}},queryForm:{deptCode:"",phonenumber:"",pageSize:this.$tableDataSize,pageNum:1},tableLoading:!1,tableData:[],total:0,bindUserDialog:!1,bindUserForm:{},rechargeDialog:!1,dropdowns:{payMode:[]},rechargeFrom:{payTime:"",amount:"",payMode:"",orderId:"",userId:""},rechargeFromRules:u}},methods:{getData(){this.tableData=[],this.tableLoading=!0,(0,d.eo)(this.queryForm).then((e=>{this.tableLoading=!1,0===e.code&&(this.total=e.total,this.tableData=e.rows)})).catch((()=>{this.tableLoading=!1}))},openBindUserDialog(e){const t=this;this.$prompt("",{title:"查询用户",inputPlaceholder:"在此输入要绑定的用户openID",beforeClose(e,t,r){if("confirm"===e){if(!t.inputValue)return this.$message.info("请输入要绑定的用户openID");r()}else r()}}).then((({value:r})=>{(0,d.Ve)({userId:r}).then((r=>{0===r.code&&(t.bindUserDialog=!0,t.bindUserForm={deptCode:e.deptCode,...r.data})}))})).catch((()=>{}))},bindUser(){(0,d.jV)({deptCode:this.bindUserForm.deptCode,userId:this.bindUserForm.user_id,id:this.bindUserForm.id}).then((e=>{0===e.code&&(this.bindUserDialog=!1,this.$message.success("绑定成功"),this.getData())}))},closeBindUserDialog(){this.bindUserDialog=!1;for(let e in this.bindUserForm)this.bindUserForm[e]=""},openRechargeDialog(e){this.rechargeDialog=!0,this.rechargeFrom.userId=e.userId,0===this.dropdowns.payMode.length&&(0,c.Wl)("3025").then((e=>{0===e.code&&(this.dropdowns.payMode=e.data)}))},recharge(){this.$refs["rechargeFrom"].validate((e=>{e&&(0,d.yJ)(this.rechargeFrom).then((e=>{0===e.code&&(this.$message.success("充值成功"),this.getData())}))}))},closeRechargeDialog(){this.rechargeDialog=!1,this.$refs["rechargeFrom"].resetFields();for(let e in this.rechargeFrom)this.rechargeFrom[e]=""}}};const u={amount:[{required:!0,message:"请输入充值金额",trigger:"blur"}],payTime:[{required:!0,message:"请选择支付时间",trigger:"change"}],payMode:[{required:!0,message:"请选择支付方式",trigger:"change"}],orderId:[{required:!0,message:"请输入交易流水号",trigger:"blur"},{min:6,max:128,message:"长度在 6 到 128 个字符",trigger:"blur"}]};var h=m,g=r(1001),b=(0,g.Z)(h,i,n,!1,null,"db45a730",null),y=b.exports}}]);