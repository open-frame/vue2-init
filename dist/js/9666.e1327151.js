"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[9666],{99666:function(e,i,t){t.r(i),t.d(i,{default:function(){return m}});var o=t(63598),a=function(){var e=this,i=e._self._c;return i("div",{},[i("el-drawer",{attrs:{title:e.data.comment+"列表",size:"40%",visible:e.show,direction:"rtl","append-to-body":!0,"modal-append-to-body":!1,"before-close":e.handleClose}},[i("div",{staticClass:"p-3"},[i(o.Z,{ref:"table",attrs:{loading:e.tableLoading,data:e.dictionDetailTable,border:!1},scopedSlots:e._u([{key:"left",fn:function(){return[i("el-input",{attrs:{size:"mini",clearable:"",placeholder:"按名称筛选"+e.data.comment},on:{clear:e.getData},model:{value:e.queryForm.name,callback:function(i){e.$set(e.queryForm,"name",i)},expression:"queryForm.name"}},[i("el-button",{attrs:{slot:"append",loading:e.tableLoading},on:{click:e.getData},slot:"append"},[e._v("搜索")])],1)]},proxy:!0},{key:"right",fn:function(){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.openDictionarieFormDialog("add")}}},[e._v("新增")])]},proxy:!0},{key:"columns",fn:function(){return[i("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"name",label:"名称"}}),i("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"codeValue",label:"值"}}),i("el-table-column",{attrs:{label:"操作","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return e.openDictionarieFormDialog("modification",t.row)}}},[e._v("编辑")]),i("el-button",{staticClass:"text-danger",attrs:{type:"text",size:"mini"},on:{click:function(i){return e.deleteing(t.row)}}},[e._v("删除")])]}}])})]},proxy:!0}])})],1)]),i("el-dialog",{attrs:{"close-on-click-modal":!1,"append-to-body":!0,"modal-append-to-body":!1,title:e.dictionarieTitle+"字典数据",visible:e.dictionarieVisible,"before-close":e.closeDictionarieDialog}},[i("el-form",{ref:"dictionarieForm",attrs:{model:e.dictionarieForm,rules:e.dictionarieRules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"值名称：",prop:"name"}},[i("el-input",{attrs:{clearable:""},nativeOn:{keyup:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter")?null:e.submitDictionarieValue.apply(null,arguments)}},model:{value:e.dictionarieForm.name,callback:function(i){e.$set(e.dictionarieForm,"name",i)},expression:"dictionarieForm.name"}})],1),i("el-form-item",{attrs:{label:"代码：",prop:"codeValue"}},[i("el-input",{nativeOn:{keyup:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter")?null:e.submitDictionarieValue.apply(null,arguments)}},model:{value:e.dictionarieForm.codeValue,callback:function(i){e.$set(e.dictionarieForm,"codeValue",i)},expression:"dictionarieForm.codeValue"}})],1)],1),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.closeDictionarieDialog}},[e._v("关 闭")]),i("el-button",{attrs:{type:"primary"},on:{click:e.submitDictionarieValue}},[e._v(e._s(e.dictionarieTitle))])],1)],1)],1)},n=[],r=t(84984),l={name:"",props:{show:{type:Boolean,default:!1},data:{type:Object,default(){return{}}}},data(){return this.dictionarieRules=s,{tableLoading:!0,queryForm:{codeValue:"",codeType:"",name:"",pageNum:1,pageSize:99999},dictionDetailTable:[],dictionarieTitle:"",dictionarieVisible:!1,dictionarieForm:{id:"",comment:"",name:"",codeValue:""}}},watch:{data(e,i){this.queryForm.pageNum=1,this.queryForm.codeType=e.codeType,this.getData()}},methods:{getData(){this.dictionDetailTable=[],this.tableLoading=!0,(0,r.eb)(this.queryForm).then((e=>{this.tableLoading=!1,0===e.code&&(this.dictionDetailTable=e.rows)})).catch((()=>{this.tableLoading=!1}))},openDictionarieFormDialog(e,i){this.dictionarieForm.comment=this.data.comment,this.dictionarieVisible=!0,"add"===e?(this.dictionarieTitle="添加",this.dictionarieForm.codeType=this.data.codeType):(this.dictionarieTitle="修改",this.dictionarieForm.id=i.id,this.dictionarieForm.codeValue=i.codeValue,this.dictionarieForm.name=i.name)},submitDictionarieValue(){const e=this.dictionDetailTable.map((e=>e.codeValue));if("添加"===this.dictionarieTitle&&e.includes(this.dictionarieForm.codeValue))return this.$message.error(`已存在代码 ${this.dictionarieForm.codeValue}`);this.$refs["dictionarieForm"].validate((e=>{e&&("添加"===this.dictionarieTitle?this.insertDictionarieValue():this.modificationDictionarieValue())}))},insertDictionarieValue(){(0,r.aY)(this.dictionarieForm).then((e=>{0===e.code&&(this.$message.success("添加成功"),this.$refs["dictionarieForm"].resetFields(),this.getData())}))},modificationDictionarieValue(){(0,r.u$)({id:this.dictionarieForm.id,name:this.dictionarieForm.name,codeValue:this.dictionarieForm.codeValue}).then((e=>{0===e.code&&(this.$message.success("修改成功"),this.getData(),this.closeDictionarieDialog(),delete this.dictionarieForm.id)}))},deleteing(e){this.$confirm("一旦删除不可恢复，确定删除？","删除提醒",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"放弃"}).then((()=>{(0,r.kM)({ids:[e.id]}).then((e=>{0===e.code&&(this.$message.success(e.msg),this.getData())}))})).catch((()=>{}))},closeDictionarieDialog(){this.$refs["dictionarieForm"].resetFields(),this.dictionarieVisible=!1},handleClose(){this.$emit("before-close",!1)}}};const s={name:[{required:!0,message:"请输入值名称",trigger:"blur"}],codeValue:[{required:!0,message:"请输入代码",trigger:"blur"}]};var c=l,d=t(1001),u=(0,d.Z)(c,a,n,!1,null,"49a65300",null),m=u.exports}}]);