"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[9698],{29698:function(e,t,o){o.r(t),o.d(t,{default:function(){return g}});var a=o(63598),r=o(71377),l=o(90649),n=o(75267),s=o(66172),i=o(67539),c=function(){var e=this,t=e._self._c;return t("el-card",{},[t(i.Z,{attrs:{loading:e.tableLoading,getData:e.getData,queryReset:e.queryReset}},[t("el-col",{attrs:{span:4}},[t(s.Z,{ref:"supplier-select",attrs:{animatLable:""},on:{change:e.pageReset},model:{value:e.queryForm.merchantNo,callback:function(t){e.$set(e.queryForm,"merchantNo",t)},expression:"queryForm.merchantNo"}})],1),t("el-col",{attrs:{span:4}},[t(n.Z,{attrs:{clearable:"",size:"medium",placeholder:"物流单号"},on:{change:e.pageReset},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData.apply(null,arguments)}},model:{value:e.queryForm.relaId,callback:function(t){e.$set(e.queryForm,"relaId",t)},expression:"queryForm.relaId"}})],1),t("el-col",{attrs:{span:4}},[t(r["default"],{attrs:{filterable:"","default-first-option":"",clearable:"",size:"medium",placeholder:"设备类型"},on:{change:e.pageReset},model:{value:e.queryForm.typeCode,callback:function(t){e.$set(e.queryForm,"typeCode",t)},expression:"queryForm.typeCode"}},e._l(e.dropdowns.typeCode,(function(e,o){return t("el-option",{key:o,attrs:{label:e.code_name,value:e.code_value}})})),1)],1),t("el-col",{attrs:{span:4}},[t(l.Z,{attrs:{size:"medium",type:"datetimerange",placeholder:"入库时间段",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptions},on:{change:e.selectTime},model:{value:e.queryForm.timeQuantum,callback:function(t){e.$set(e.queryForm,"timeQuantum",t)},expression:"queryForm.timeQuantum"}})],1),t("el-col",{attrs:{span:4}},[t(r["default"],{attrs:{filterable:"","default-first-option":"",clearable:"",size:"medium",placeholder:"入库类型"},on:{change:e.pageReset},model:{value:e.queryForm.ioWhReasonCode,callback:function(t){e.$set(e.queryForm,"ioWhReasonCode",t)},expression:"queryForm.ioWhReasonCode"}},e._l(e.dropdowns.ioWhReasonCode,(function(e,o){return t("el-option",{key:o,attrs:{label:e.code_name,value:e.code_value}})})),1)],1)],1),t("el-divider"),t(a.Z,{ref:"table",attrs:{loading:e.tableLoading,total:e.total,data:e.tableData,height:"550","row-key":"device_name","page-size":e.queryForm.pageSize,"current-page":e.queryForm.pageNum},on:{"size-change":e.dataSizeChange,"current-change":e.handleCurrentChange,"selection-change":e.selectingData},scopedSlots:e._u([{key:"left",fn:function(){return[t("el-button",{attrs:{size:"small",icon:"el-icon-plus"},on:{click:function(t){e.insertDeviceVisible=!0}}},[e._v("入库")]),t("el-dropdown",{attrs:{trigger:"click"},on:{command:e.downloadTemplate}},[t("el-button",{attrs:{icon:"el-icon-download",size:"small"}},[e._v(" 入库模板下载"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.dropdowns.typeCode,(function(o,a){return t("el-dropdown-item",{key:a,attrs:{command:o.code_value}},[e._v(" "+e._s(o.code_name)+" ")])})),1)],1),t("el-button",{attrs:{size:"small",icon:"el-icon-delete"},on:{click:function(t){return e.deleteInventoryInsert("more")}}},[e._v("删除")])]},proxy:!0},{key:"columns",fn:function(){return[t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"入库单号",prop:"ioWhId"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"设备类型",prop:"typeCode"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("transfortext")(t.row.typeCode,e.dropdowns.typeCode))+" ")]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"设备型号",prop:"modelCode"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("transfortext")(t.row.modelCode,e.dropdowns.modelCode))+" ")]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"入库类型",prop:"ioWhReasonCode"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("transfortext")(t.row.ioWhReasonCode,e.dropdowns.ioWhReasonCode))+" ")]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"入库数量",prop:"ioWhNum"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"入库时间",prop:"rcvReturnDate"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"到货时间",prop:"arriveTime"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"入库人",prop:"fetchEmpName"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"库房",prop:"whNo"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("transfortext")(t.row.whNo,e.dropdowns.whNo,{name:"name",value:"whNo"}))+" ")]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"物流单号",prop:"relaId"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"生产厂家",prop:"merchantNo"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("transfortext")(t.row.merchantNo,e.dropdowns.merchantNo,{name:"merchantName",value:"merchantNo"}))+" ")]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"状态",prop:"createStatus"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("transfortext")(t.row.createStatus,e.dropdowns.createStatus))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"170",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-button",{attrs:{plain:"",type:"primary",size:"mini"},on:{click:function(t){return e.openInsertInventory(o.row)}}},[e._v(" "+e._s("1"===o.row.createStatus?"库管审核":"详情")+" ")]),t("el-button",{attrs:{plain:"",type:"danger",size:"mini"},on:{click:function(t){return e.deleteInventoryInsert("one",o.row)}}},[e._v(" 删除 ")])]}}])})]},proxy:!0}])}),t("incom-detail",{attrs:{show:e.supplierDataVisible,data:e.supplierData},on:{success:e.getData,close:e.closeSupplierDataVisible}}),t("insert-device",{attrs:{show:e.insertDeviceVisible},on:{success:e.importDeviceSuccess,close:e.closeInsertDeviceVisible}})],1)},d=[],u=o(74713),p=o(5376),m=o(1161),h=o(90886),f=o(30741),w={name:"property-inventory-insert-index",mixins:[f.LI,f.I_,f.oA,f.vd],components:{"incom-detail":()=>Promise.all([o.e(8005),o.e(3898)]).then(o.bind(o,93898)),"insert-device":()=>o.e(8305).then(o.bind(o,18305))},filters:{transfortext:h.h},data(){return{pickerOptions:{disabledDate(e){return e.getTime()>Date.now()}},tableLoading:!1,dropdowns:{createStatus:[],typeCode:[],modelCode:[],ioWhReasonCode:[],merchantNo:[],whNo:[]},queryForm:{timeQuantum:[],typeCode:"",startTime:"",endTime:"",merchantNo:"",relaId:"",pageSize:this.$tableDataSize,pageNum:1},tableData:[],total:0,selectedMoreData:[],insertDeviceVisible:!1,supplierDataVisible:!1,supplierData:{}}},created(){this.getDropdowns()},methods:{getDropdowns(){(0,p.Wl)("45258").then((e=>{0===e.code&&(this.dropdowns.createStatus=e.data)})),(0,p.Wl)("3004").then((e=>{0===e.code&&(this.dropdowns.typeCode=e.data)})),(0,p.Wl)("3005").then((e=>{0===e.code&&(this.dropdowns.modelCode=e.data)})),(0,p.Wl)("45256").then((e=>{0===e.code&&(this.dropdowns.ioWhReasonCode=e.data)})),(0,u.aM)({}).then((e=>{0===e.code&&(this.dropdowns.whNo=e.rows)})),(0,u.rH)({}).then((e=>{0===e.code&&(this.dropdowns.merchantNo=e.rows)}))},selectTime(e){this.queryForm.pageNum=1,e?(this.queryForm.startTime=e[0],this.queryForm.endTime=e[1]):(this.queryForm.startTime="",this.queryForm.endTime="")},getData(){this.tableLoading=!0,this.tableData=[],(0,u.ZH)(this.queryForm).then((e=>{0===e.code&&(this.tableData=e.rows,this.total=e.total)})).finally((()=>{this.tableLoading=!1}))},selectingData(e){this.selectedMoreData=e},downloadTemplate(e){let t;const o=this.dropdowns.typeCode.find((t=>e===t.code_value)).code_name;["1","2","3"].includes(e)&&(t=[{"MAC/ID":"86482351111","产品序列号":"23213123","固件版本号":"1113","设备名称":o+"01153","设备类型":o,"设备型号":"ML-200","额定电流(A)":"10","额定电压(V)":"220","额定功率(W)":"2200","NB卡号":"3213213213","批次号":"1111111","出厂编号":"4213215431","出厂日期":"2020-01-22 12:44:10","产品标识":"7665323144642124","设备密钥":"cc76w454321a2674j3g65"}]),"4"===e&&(t=[{"IMEI(设备编号)":"86482351111","设备名称":o+"03112","地址码":"110309921012","模块编号":"4213213435414","设备类型":o,"设备型号":"ML-200","NB卡号":"3213213213","批次号":"1111111","出厂编号":"4213215431","出厂日期":"2020-01-22 12:44:10","产品标识":"7665323144642124","设备密钥":"cc76w454321a2674j3g65"}]),"5"===e&&(t=[{"IMEI(设备编号)":"86482351111","设备名称":o+"03112","设备类型":o,"设备型号":"ML-200","NB卡号":"3213213213","批次号":"1111111","出厂编号":"4213215431","出厂日期":"2020-01-22 12:44:10","产品标识":"7665323144642124","设备密钥":"cc76w454321a2674j3g65"}]),(0,m.rD)(t,o+"填写模板"),this.$message.info("使用前请将模板中的示例数据删掉")},deleteInventoryInsert(e,t){if("one"===e&&this.selectingData([t]),0===this.selectedMoreData.length)return this.$message.warning("请选择要删除的电表"),!1;this.$confirm("一旦删除不可恢复，确定删除？","删除提醒",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"放弃"}).then((()=>{(0,u._S)({ids:this.selectedMoreData.map((e=>e.ioWhId))}).then((e=>{0===e.code&&(this.$refs.table.clearSelection(),this.$message.success("删除成功"),this.getData())}))})).catch((()=>{}))},openInsertInventory(e){this.supplierDataVisible=!0,this.supplierData={...e}},closeSupplierDataVisible(e){this.supplierDataVisible=e},closeInsertDeviceVisible(e){this.insertDeviceVisible=e},importDeviceSuccess(e){this.getData(),this.supplierData=e,this.supplierDataVisible=!0},async exporting(e){let t={...this.queryForm};"2"===e&&(t.pageSize=this.total,t.pageNum=1);const o=await(0,u.ZH)(t);if(0===o.code){const e=this.$refs.table.getColumns(),t=o.rows.map((t=>{let o=e.map((e=>[e.label,`${(0,h.h)(t[e.prop],this.dropdowns[e.prop])}`]));return Object.fromEntries(o)}));return t}}}},y=w,b=o(1001),v=(0,b.Z)(y,c,d,!1,null,"6aa6762e",null),g=v.exports}}]);