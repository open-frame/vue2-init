"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[7405],{7405:function(t,e,a){a.r(e),a.d(e,{default:function(){return h}});var r=a(63598),i=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],ref:"print-resault",attrs:{id:"print-resault"}},[t._m(0),e("div",{staticClass:"ps-2"},[t._v("清分单号："+t._s(t.printData.clearNo))]),e("div",{staticClass:"border border-dark"},[e("el-row",{staticClass:"p-2",attrs:{gutter:30}},[e("el-col",{attrs:{span:12}},[e("span",[t._v("清分月份：")]),e("span",[t._v(t._s(t.printData.clearMon))])]),e("el-col",{attrs:{span:12}},[e("span",[t._v("清分期限：")]),e("span",[t._v(t._s(t.printData.clearPeriod))])]),e("el-col",{attrs:{span:12}},[e("span",[t._v("商户名称：")]),e("span",[t._v(t._s(t.printData.merchantName))])])],1),e("el-divider",{staticClass:"m-0 bg-dark"}),e("el-row",{staticClass:"p-2",attrs:{gutter:30}},[e("el-col",{attrs:{span:24}},[e("h6",[t._v("场站信息：")])]),e("el-col",{attrs:{span:12}},[e("span",[t._v("电站数量：")]),e("span",[t._v(t._s(t.printData.stationNumber))])]),e("el-col",{attrs:{span:12}},[e("span",[t._v("设备数量：")]),e("span",[t._v(t._s(t.printData.stakeNumber))])]),e("el-col",{attrs:{span:12}},[e("span",[t._v("本期平均在线率：")]),e("span",[t._v(t._s(t.printData.avgOnline))])]),e("el-col",{attrs:{span:12}},[e("span",[t._v("本期平均使用率：")]),e("span",[t._v(t._s(t.printData.avgUse))])])],1),e("el-divider",{staticClass:"m-0 bg-dark"}),e("div",{staticClass:"p-2"},[e("h6",[t._v("清分规则")]),e("div",{staticClass:"fw-light mb-2"},[t._v(" 平台按照下表比例与商户清分"+t._s(t.printData.clearPeriod)+"时段内有效订单金额 ")]),e(r.Z,{staticClass:"w-prose print-table",staticStyle:{margin:"0 auto"},attrs:{border:!1,size:"mini",data:t.printData.percent},scopedSlots:t._u([{key:"columns",fn:function(){return[e("el-table-column",{attrs:{type:"index",label:"序号",width:"55"}}),e("el-table-column",{attrs:{prop:"itemName",label:"清分项目"}}),e("el-table-column",{attrs:{prop:"merchantRatio",label:"商户占比"}})]},proxy:!0}])})],1),e("el-divider",{staticClass:"m-0 bg-dark"}),e("div",[e("h6",{staticClass:"ps-2 pt-2"},[t._v("清分信息")]),e("div",{staticClass:"p-2"},[e("p",[t._v("平台侧可结算信息")]),e(r.Z,{staticClass:"print-table",staticStyle:{margin:"0 auto"},attrs:{size:"mini",data:t.platformClearOrder,"span-method":t.mergeTableRow},scopedSlots:t._u([{key:"columns",fn:function(){return[e("el-table-column",{attrs:{prop:"period",width:"120"}}),e("el-table-column",{attrs:{prop:"itemName",label:"清分项目"}}),e("el-table-column",{attrs:{prop:"orderNum",label:"订单数量"}}),e("el-table-column",{attrs:{prop:"clearMony",label:"金额"}}),e("el-table-column",{attrs:{prop:"total",label:"实收合计"}}),e("el-table-column",{attrs:{prop:"serviceCharge",label:"应扣手续费"}}),e("el-table-column",{attrs:{prop:"noClearMony",label:"未结算金额"}})]},proxy:!0}])})],1),e("el-divider",{staticClass:"m-0"}),e("div",{staticClass:"p-2"},[e("p",[t._v("商户侧结算信息")]),e(r.Z,{staticClass:"print-table",staticStyle:{margin:"0 auto"},attrs:{size:"mini",data:t.commercialClearOrder,"span-method":t.mergeTableRow},scopedSlots:t._u([{key:"columns",fn:function(){return[e("el-table-column",{attrs:{prop:"period",width:"120"}}),e("el-table-column",{attrs:{prop:"itemName",label:"清分项目"}}),e("el-table-column",{attrs:{prop:"merchantRatio",label:"商户占比"}}),e("el-table-column",{attrs:{prop:"merchantMoney",label:"应分金额"}}),e("el-table-column",{attrs:{prop:"total",label:"应分合计"}}),e("el-table-column",{attrs:{prop:"serviceCharge",label:"应扣手续费"}}),e("el-table-column",{attrs:{prop:"clearMoney",label:"结算金额"}})]},proxy:!0}])})],1)],1),e("el-divider",{staticClass:"m-0 bg-dark"}),t._m(1),e("el-divider",{staticClass:"m-0 bg-dark"}),e("el-row",{staticClass:"ps-2 pe-2",attrs:{gutter:30}},[e("el-col",{attrs:{span:8}},[t._v("编制人：")]),e("el-col",{attrs:{span:8}},[t._v(" 商户确认：")]),e("el-col",{attrs:{span:8}},[t._v(" 复核人：")])],1)],1)])},n=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-center"},[e("div",[t._v("伊莎能源车联网运营平台")]),e("div",{staticClass:"fw-300"},[t._v("清分结算单")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"p-2"},[e("h6",[t._v("清分说明")]),e("div",{staticClass:"p-2"},[e("p",[t._v(" 1、商户的开票金额为应分合计扣除手续费之后的结算金额。开票金额=本期总订单结算金额+本期追收订单结算金额-本期退款订单结算金额。 ")]),e("p",[t._v(" 2、商户本期总订单结算金额是清分周期内按比例算出的商户应得的结算总金额。 ")]),e("p",[t._v(" 3、商户本期退款订单结算金额是清分周期内，充电用户发生了退款，按比例算出的商户应扣除的结算总金额。 ")]),e("p",[t._v(" 4、商户本期追收订单结算金额是订单开始时间不在清分周期内，但是充电用户付款时间在清分周期内，按照比例算出的商户应得的结算总金额。 ")]),e("p",[t._v(" 5、手续费：在微信支付平台进行交易，微信侧收取的手续费，按千分之六的比例从每笔订单中扣除。 ")])])])}],s=a(92617),l=a(25335),o=a(5376),p={name:"",data(){return{loading:!0,printData:{},dropdowns:{depositBank:[]},platformClearOrder:[],commercialClearOrder:[]}},props:{show:{type:Boolean,require:!0},clearNo:{type:String,require:!0}},methods:{getDropdowns(){this.loading=this.$loading({lock:!0,text:"正在拉取字典...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});const t=[(0,o.Wl)("3027")],e=this;s.o.all(t).then(s.o.spread(((t,a,r)=>{e.dropdowns.depositBank=t.data,e.getData()}))).catch((()=>{this.loading.close()}))},getData(){this.loading.text="正在获取结算单数据...",(0,l.xk)({clearNo:this.clearNo}).then((t=>{0===t.code&&(this.printData=t.data,this.printData.percent=[{itemName:"电费",merchantRatio:t.data.elecMoney},{itemName:"服务费",merchantRatio:t.data.serviceMoney}],this.computePlatformClearOrder())})).catch((()=>{this.loading.close()}))},computePlatformClearOrder(){this.loading.text="正在格式化数据...";const t=[{period:"本期总订单",orderNum:this.printData.orderNum,itemName:"电费",clearMony:this.printData.orderClearElecSum,total:this.printData.orderClearMoney,serviceCharge:this.printData.orderHandlingSum,noClearMony:this.printData.orderUnsettled},{period:"本期总订单",orderNum:this.printData.orderNum,itemName:"服务费",clearMony:this.printData.orderClearServiceSum,total:this.printData.orderClearMoney,serviceCharge:this.printData.orderHandlingSum,noClearMony:this.printData.orderUnsettled},{period:"本期追收订单",orderNum:this.printData.lastNum,itemName:"电费",clearMony:this.printData.recoverOrderElecSum,total:this.printData.recoverOrderMoney,serviceCharge:this.printData.recoverHandlingSum,noClearMony:this.printData.recoverOrderUnsettled},{period:"本期追收订单",orderNum:this.printData.lastNum,itemName:"服务费",clearMony:this.printData.recoverOrderServiceSum,total:this.printData.recoverOrderMoney,serviceCharge:this.printData.recoverHandlingSum,noClearMony:this.printData.recoverOrderUnsettled},{period:"本期退款订单",orderNum:this.printData.backNum,itemName:"电费",clearMony:this.printData.backOrderElecSum,total:this.printData.backOrderMoney,serviceCharge:this.printData.backHandlingSum,noClearMony:this.printData.backOrderUnsettled},{period:"本期退款订单",orderNum:this.printData.backNum,itemName:"服务费",clearMony:this.printData.backOrderServiceSum,total:this.printData.backOrderMoney,serviceCharge:this.printData.backHandlingSum,noClearMony:this.printData.backOrderUnsettled},{period:"总计",orderNum:this.printData.orderNum+this.printData.lastNum+this.printData.backNum,itemName:"",clearMony:this.printData.totalAmount,total:this.printData.totalBalance,serviceCharge:this.printData.totalHandlingSum,noClearMony:this.printData.totalUnsettled}];this.platformClearOrder=this.mergeTableRowMethod(t,["period","orderNum","total","serviceCharge","noClearMony"]),this.computeCommercialClearOrder()},computeCommercialClearOrder(){const t=[{period:"本期总订单",itemName:"电费",merchantRatio:this.printData.elecMoney,merchantMoney:this.printData.mOrderClearElecSum,total:this.printData.mOrderClearMoney,serviceCharge:this.printData.mOrderHandlingSum,clearMoney:this.printData.mOrderSettlement},{period:"本期总订单",itemName:"服务费",merchantRatio:this.printData.serviceMoney,merchantMoney:this.printData.mOrderClearServiceSum,total:this.printData.mOrderClearMoney,serviceCharge:this.printData.mOrderHandlingSum,clearMoney:this.printData.mOrderSettlement},{period:"本期追收订单",itemName:"电费",merchantRatio:this.printData.elecMoney,merchantMoney:this.printData.mRecoverOrderElecSum,total:this.printData.mRecoverOrderMoney,serviceCharge:this.printData.mRecoverHandlingSum,clearMoney:this.printData.mRecoverOrderSettlement},{period:"本期追收订单",itemName:"服务费",merchantRatio:this.printData.serviceMoney,merchantMoney:this.printData.mRecoverOrderServiceSum,total:this.printData.mRecoverOrderMoney,serviceCharge:this.printData.mRecoverHandlingSum,clearMoney:this.printData.mRecoverOrderSettlement},{period:"本期退款订单",itemName:"电费",merchantRatio:this.printData.elecMoney,merchantMoney:this.printData.mBackOrderElecSum,total:this.printData.mBackOrderMoney,serviceCharge:this.printData.mBackHandlingSum,clearMoney:this.printData.mBackOrderSettlement},{period:"本期退款订单",itemName:"服务费",merchantRatio:this.printData.serviceMoney,merchantMoney:this.printData.mBackOrderServiceSum,total:this.printData.mBackOrderMoney,serviceCharge:this.printData.mBackHandlingSum,clearMoney:this.printData.mBackOrderSettlement},{period:"总计",itemName:"",merchantRatio:"",merchantMoney:this.printData.mTotalAmountC,total:this.printData.mTotalBalanceC,serviceCharge:this.printData.mTotalHandlingSum,clearMoney:this.printData.mTotalSettlement}];this.commercialClearOrder=this.mergeTableRowMethod(t,["period","total","serviceCharge","clearMoney"]),this.print()},mergeTableRow({row:t,column:e,rowIndex:a,columnIndex:r}){const i=e["property"]+"-span";if(t[i])return t[i]},mergeTableRowMethod(t,e){return e&&0!==e.length?(e.forEach((e=>{const a={};t=t.map(((r,i)=>{const n=r[e];return a[n]&&a[n].newIndex===i?(a[n]["num"]++,a[n]["newIndex"]++,t[a[n]["index"]][e+"-span"].rowspan++,r[e+"-span"]={rowspan:0,colspan:0}):(a[n]={num:1,index:i,newIndex:i+1},r[e+"-span"]={rowspan:1,colspan:1}),r}))})),t):t},print(){this.loading.text="正在唤醒打印...";const t=this;this.$nextTick((()=>{const e=this.$refs["print-resault"],r=a(36801);r({maxWidth:window.innerWidth,type:"html",printable:e,targetStyles:["*"],onLoadingEnd(){t.$emit("show",!1)}}),this.loading.close()}))}}},c=p,m=a(1001),d=(0,m.Z)(c,i,n,!1,null,"5bca5f10",null),h=d.exports}}]);