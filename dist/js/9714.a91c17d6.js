"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[9714],{69714:function(e,t,r){r.r(t),r.d(t,{default:function(){return w}});var a=r(1985),o=r(63598),s=r(98005),l=r(67539),i=function(){var e=this,t=e._self._c;return t("el-card",{},[t(l.Z,{attrs:{loading:e.tableLoading,btnSpan:20,getData:e.getData,queryReset:e.queryReset}},[t("el-col",{attrs:{span:4}},[t(s.Z,{ref:"warehouse-select",attrs:{animatLable:""},on:{change:e.pageReset},model:{value:e.queryForm.whNo,callback:function(t){e.$set(e.queryForm,"whNo",t)},expression:"queryForm.whNo"}})],1)],1),t("el-divider"),t(o.Z,{ref:"table",attrs:{loading:e.tableLoading,total:e.total,data:e.tableData,height:"550","row-key":"whNo","page-size":e.queryForm.pageSize,"current-page":e.queryForm.pageNum,derive:e.exporting},on:{"size-change":e.dataSizeChange,"current-change":e.handleCurrentChange},scopedSlots:e._u([{key:"left",fn:function(){return[t("el-button",{attrs:{size:"small",icon:"el-icon-plus"},on:{click:function(t){return e.editing("add")}}},[e._v("新增")])]},proxy:!0},{key:"columns",fn:function(){return[t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"库房编号",prop:"whNo"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"库房名称",prop:"name"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"管理单位",prop:"belongOrg"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("transfortext")(t.row.belongOrg,e.dropdowns.belongOrg,{name:"label",value:"deptCode"}))+" ")]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"库房地址",prop:"whAddr"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"库房面积（㎡）",prop:"tsize"}}),t("el-table-column",{attrs:{label:"库房责任人",prop:"personRespNo"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"联系方式",prop:"phone"}}),t("el-table-column",{attrs:{label:"操作",width:"100",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{plain:"",size:"mini",type:"primary"},on:{click:function(t){return e.editing("modification",r.row)}}},[e._v(" 详情 ")])]}}])})]},proxy:!0}])}),t("el-dialog",{attrs:{"close-on-click-modal":!1,title:e.supplierDataVisibleText+"库房","append-to-body":!0,"modal-append-to-body":!1,visible:e.supplierDataVisible,"before-close":e.closeWarehouseDataVisible}},[t("el-form",{ref:"submitWarehouseForm",attrs:{model:e.submitWarehouseForm,rules:e.rules,"label-width":"150px"}},["修改"===e.supplierDataVisibleText?t("el-form-item",{attrs:{label:"库房编号",prop:"whNo"}},[t("el-input",{attrs:{clearable:"",readonly:"新增"!==e.supplierDataVisibleText},model:{value:e.submitWarehouseForm.whNo,callback:function(t){e.$set(e.submitWarehouseForm,"whNo",t)},expression:"submitWarehouseForm.whNo"}})],1):e._e(),t("el-form-item",{attrs:{label:"库房名称",prop:"name"}},[t("el-input",{attrs:{clearable:""},model:{value:e.submitWarehouseForm.name,callback:function(t){e.$set(e.submitWarehouseForm,"name",t)},expression:"submitWarehouseForm.name"}})],1),t("el-form-item",{attrs:{label:"库房地址",prop:"whAddr"}},[t("el-input",{attrs:{clearable:""},model:{value:e.submitWarehouseForm.whAddr,callback:function(t){e.$set(e.submitWarehouseForm,"whAddr",t)},expression:"submitWarehouseForm.whAddr"}})],1),t("el-form-item",{attrs:{label:"所属组织",prop:"belongOrg"}},[t(a.Z,{attrs:{placeholder:""},model:{value:e.submitWarehouseForm.belongOrg,callback:function(t){e.$set(e.submitWarehouseForm,"belongOrg",t)},expression:"submitWarehouseForm.belongOrg"}})],1),t("el-form-item",{attrs:{label:"库房面积",prop:"tsize"}},[t("el-input-number",{attrs:{precision:2,"controls-position":"right"},model:{value:e.submitWarehouseForm.tsize,callback:function(t){e.$set(e.submitWarehouseForm,"tsize",t)},expression:"submitWarehouseForm.tsize"}})],1),t("el-form-item",{attrs:{label:"责任人",prop:"personRespNo"}},[t("el-input",{attrs:{clearable:""},model:{value:e.submitWarehouseForm.personRespNo,callback:function(t){e.$set(e.submitWarehouseForm,"personRespNo",t)},expression:"submitWarehouseForm.personRespNo"}})],1),t("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[t("el-input",{attrs:{clearable:""},model:{value:e.submitWarehouseForm.phone,callback:function(t){e.$set(e.submitWarehouseForm,"phone",t)},expression:"submitWarehouseForm.phone"}})],1),t("el-form-item",{attrs:{label:"备注",prop:"remark"}},[t("el-input",{attrs:{type:"textarea",clearable:""},model:{value:e.submitWarehouseForm.remark,callback:function(t){e.$set(e.submitWarehouseForm,"remark",t)},expression:"submitWarehouseForm.remark"}})],1)],1),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeWarehouseDataVisible}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitWarehouse}},[e._v(" "+e._s(e.supplierDataVisibleText)+" ")])],1)],1)],1)},u=[],n=r(74713),m=r(5376),p=r(90886),b=r(30741),h={name:"property-warehouse-index",mixins:[b.LI,b.I_,b.oA,b.vd],filters:{transfortext:p.h},data(){return this.rules=g,{tableLoading:!1,dropdowns:{belongOrg:[]},queryForm:{whNo:"",pageSize:this.$tableDataSize,pageNum:1},tableData:[],total:0,supplierDataVisibleText:"",supplierDataVisible:!1,submitWarehouseForm:{whNo:"",name:"",whAddr:"",tsize:"",personRespNo:"",phone:"",remark:"",belongOrg:""}}},created(){this.getDropdowns()},methods:{getData(){this.tableLoading=!0,this.tableData=[],(0,n.aM)(this.queryForm).then((e=>{this.tableLoading=!1,0===e.code&&(this.tableData=e.rows,this.total=e.total)})).catch((()=>{this.tableLoading=!1}))},getDropdowns(){(0,m.eL)().then((e=>{this.dropdowns.belongOrg=e}))},editing(e,t){if(this.supplierDataVisible=!0,"add"===e)this.supplierDataVisibleText="添加";else{this.supplierDataVisibleText="修改";const e=this;this.$nextTick((()=>{for(let r in e.submitWarehouseForm)e.submitWarehouseForm[r]=t[r]}))}},submitWarehouse(){this.$refs["submitWarehouseForm"].validate((e=>{e&&(0,n.IV)(this.submitWarehouseForm).then((e=>{0===e.code&&(this.$message.success(e.msg),this.getData(),this.closeWarehouseDataVisible())}))}))},closeWarehouseDataVisible(){this.supplierDataVisible=!1,this.$refs["submitWarehouseForm"].resetFields()},async exporting(e){let t={...this.queryForm};"2"===e&&(t.pageSize=this.total,t.pageNum=1);const r=await(0,n.aM)(t);if(0===r.code){const e=this.$refs.table.getColumns(),t=r.rows.map((t=>{let r=e.map((e=>[e.label,`${(0,p.h)(t[e.prop],this.dropdowns[e.prop])}`]));return Object.fromEntries(r)}));return t}}}};const g={name:[{required:!0,message:"库房名称必填项！",trigger:"blur"},{pattern:/^[\u4e00-\u9fa5 0-9]*$/,message:"只能支持中文汉字、数字",trigger:"blur"},{min:2,max:48,message:"长度在 2 到 48 个字符",trigger:"blur"}],phone:[{required:!0,message:"联系方式为必填项！",trigger:"blur"},{pattern:/^[0-9]+$/,message:"只能为数字",trigger:"blur"},{min:7,max:16,message:"长度在 7 到 16 个字符",trigger:"blur"}],whAddr:[{required:!0,message:"请输入地址",trigger:"blur"},{pattern:/^[^<|>|(|)|+|-|*|/|%|=]*$/,message:"禁止< > ( ) + - * / % = 等特殊字符",trigger:"blur"},{min:3,max:48,message:"长度在 3 到 48 个字符",trigger:"blur"}],tsize:[{required:!0,message:"请输入库房面积",trigger:"blur"},{type:"number",min:.01,max:9999999999,message:"请输入正确的库房面积"}],personRespNo:[{required:!0,message:"责任人必填项！",trigger:"blur"},{pattern:/^[\u4e00-\u9fa5]*$/,message:"只能为中文汉字",trigger:"blur"},{min:2,max:48,message:"长度在 2 到 48 个字符",trigger:"blur"}],remark:[{pattern:/^[^<|>|(|)|+|-|*|/|%|=]*$/,message:"禁止< > ( ) + - * / % = 等特殊字符",trigger:"blur"},{min:3,max:2048,message:"长度在 3 到 2048 个字符",trigger:"blur"}],belongOrg:[{required:!0,message:"请选择所属组织",trigger:"change"}]};var c=h,d=r(1001),f=(0,d.Z)(c,i,u,!1,null,"10c6d3aa",null),w=f.exports}}]);