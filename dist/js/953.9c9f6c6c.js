"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[953,5376,2453,1226,2335,6122],{5376:function(e,o,t){t.d(o,{Jz:function(){return i},Wl:function(){return r},eL:function(){return l},hv:function(){return d},iS:function(){return n},oP:function(){return a}});t(57658);var s=t(92617);function r(e,o){return s.o.post("/select/box/selectBoxPoint",{codeType:e},o)}function a(e,o){return s.o.post("/system/dept/treeData",e,o)}async function l(e,o){const t=await s.o.post("/system/dept/treeData",e,o);let r=[];return 0===t.code&&function e(o){o.map((o=>{o.children&&e(o.children),r.push(o)}))}(t.data),r}function i(e,o){return s.o.post("/flow/monitor/getAssigneeList",e,o)}function n(){return s.o.get("/assetStake/getStationListByLoginUser")}function d(){return s.o.get("/system/user/add")}},10953:function(e,o,t){t.r(o),t.d(o,{default:function(){return c}});var s=function(){var e=this,o=e._self._c;return o("el-dialog",{attrs:{"close-on-click-modal":!1,"append-to-body":!0,"modal-append-to-body":!1,title:"处理工单",visible:e.show,"show-close":!1}},[o("el-form",{ref:"disposeForm",attrs:{model:e.disposeForm,rules:e.disposeRules,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"处理状态：",prop:"operatorResult"}},[o("el-select",{attrs:{filterable:"","default-first-option":"",clearable:"",placeholder:"请选择处理处理状态"},model:{value:e.disposeForm.operatorResult,callback:function(o){e.$set(e.disposeForm,"operatorResult",o)},expression:"disposeForm.operatorResult"}},[o("el-option",{attrs:{label:"处理中",value:"2"}}),o("el-option",{attrs:{label:"处理完成",value:"4"}})],1)],1),o("el-form-item",{attrs:{label:"处理描述：",prop:"msgDetail"}},[o("el-input",{attrs:{clearable:"",placeholder:"请输入处理描述"},model:{value:e.disposeForm.msgDetail,callback:function(o){e.$set(e.disposeForm,"msgDetail",o)},expression:"disposeForm.msgDetail"}})],1),o("el-form-item",{attrs:{label:"是否派工单",prop:"forWorker"}},[o("el-select",{attrs:{filterable:"","default-first-option":"",clearable:"",placeholder:""},model:{value:e.disposeForm.forWorker,callback:function(o){e.$set(e.disposeForm,"forWorker",o)},expression:"disposeForm.forWorker"}},e._l(e.dropdowns.yesORno,(function(e,t){return o("el-option",{key:t,attrs:{label:e.code_name,value:e.code_value}})})),1)],1),"1"===e.disposeForm.forWorker?[o("el-form-item",{attrs:{label:"故障类型",prop:"uploadType"}},[o("el-select",{attrs:{filterable:"","default-first-option":"",clearable:"",placeholder:""},model:{value:e.disposeForm.uploadType,callback:function(o){e.$set(e.disposeForm,"uploadType",o)},expression:"disposeForm.uploadType"}},e._l(e.dropdowns.uploadType,(function(e,t){return o("el-option",{key:t,attrs:{label:e.code_name,value:e.code_value}})})),1)],1),o("el-form-item",{attrs:{label:"故障标识",prop:"warnCode"}},[o("el-select",{attrs:{filterable:"","default-first-option":"",clearable:"",placeholder:""},model:{value:e.disposeForm.warnCode,callback:function(o){e.$set(e.disposeForm,"warnCode",o)},expression:"disposeForm.warnCode"}},e._l(e.dropdowns.warnCode,(function(e,t){return o("el-option",{key:t,attrs:{label:e.code_name,value:e.code_value}})})),1)],1)]:e._e()],2),o("span",{attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.close}},[e._v("关 闭")]),o("el-button",{attrs:{type:"primary"},on:{click:function(o){return e.dispose("disposeForm")}}},[e._v("处 理")])],1)],1)},r=[],a=t(89176),l=t(5376),i={name:"",data(){return this.disposeRules=n,{dropdowns:{yesORno:[],warnCode:[],uploadType:[]},disposeForm:{operatorResult:"",msgDetail:"",forWorker:"",warnCode:"",uploadType:""}}},created(){this.getDropdowns()},props:{show:{type:Boolean,default:!1},data:{type:Object,default(){return{}}}},methods:{getDropdowns(){(0,l.Wl)("1036").then((e=>{0===e.code&&(this.dropdowns.yesORno=e.data)})),(0,l.Wl)("63000").then((e=>{0===e.code&&(this.dropdowns.warnCode=e.data)})),(0,l.Wl)("63001").then((e=>{0===e.code&&(this.dropdowns.uploadType=e.data)}))},dispose(e){this.$refs[e].validate((e=>{if(!e)return!1;(0,a.tZ)({workOrderId:this.data.workOrderId,operatorResult:this.disposeForm.operatorResult,msgDetail:this.disposeForm.msgDetail}).then((e=>{0===e.code&&(this.$emit("success"),this.$message.success("处理成功"),"1"===this.disposeForm.forWorker&&this.forWorker(),this.close())}))}))},forWorker(){(0,a.ku)({stationNo:this.data.stationNo,stakeNo:this.data.stakeNo,warnCode:this.disposeForm.warnCode,detail:this.disposeForm.msgDetail,uploadType:this.disposeForm.uploadType}).then((e=>{0===e.code&&this.$message.success("已派发工单")}))},close(){this.$refs["disposeForm"].resetFields(),this.$emit("close",!1)}}};const n={operatorResult:[{required:!0,message:"请选择处理处理状态",trigger:"change"}],msgDetail:[{required:!0,message:"请输入处理描述",trigger:"blur"},{pattern:/^[^<|>|(|)|+|-|*|/|%|=|{|}]*$/,message:"禁止< > ( ) + - * / % = { }等特殊字符",trigger:"blur"},{min:2,max:128,message:"长度在 2 到 128 个字符",trigger:"blur"}]};var d=i,p=t(1001),u=(0,p.Z)(d,s,r,!1,null,"f0f545a8",null),c=u.exports}}]);