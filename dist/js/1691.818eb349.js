(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[1691],{1985:function(e,t,o){"use strict";o.d(t,{Z:function(){return w}});var n=function(){var e=this,t=e._self._c;return t("div",{},[t("div",{staticClass:"flex flex-justify-between flex-items-end"},[t("el-button-group",{staticClass:"flex functions"},[e._t("left"),e.derive?t("el-dropdown",{attrs:{disabled:e.data.length<1,trigger:"click"},on:{command:e.exporting}},[t("el-button",{attrs:{size:e.size}},[e._v(" 导出"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"1"}},[e._v("导出本页")]),t("el-dropdown-item",{attrs:{command:"2"}},[e._v("导出全部")])],1)],1):e._e(),e.$listeners.printing?t("el-dropdown",{attrs:{disabled:e.data.length<1,trigger:"click"},on:{command:e.printing}},[t("el-button",{attrs:{size:e.size}},[e._v(" 打印"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"1"}},[e._v("打印本页")]),t("el-dropdown-item",{attrs:{command:"2"}},[e._v("打印全部")])],1)],1):e._e()],2),t("el-button-group",[e._t("right")],2)],1),t("el-table",e._b({directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",attrs:{"header-cell-style":{...e.headerCellStyle,...e.style.headerCell},"cell-style":e.cellStyle,"header-cell-class-name":"text-center","row-class-name":e.rowClassName,size:e.size,data:e.data,border:e.border,"row-key":e.rowKey,"empty-text":e.emptyText,"show-summary":e.showSummary,"summary-method":e.summaryMethod,"tooltip-effect":"dark","highlight-current-row":"","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{"row-click":e.rowClick,"cell-click":e.cellClick,select:e.select,"select-all":e.selectAll,"selection-change":e.selectionChange,"row-dblclick":e.rowDblclick}},"el-table",e._d({},[e.olyHeight,e.height||e.maxHeight||"400"])),[e.showSelection?t("el-table-column",{attrs:{fixed:"left",type:"selection","reserve-selection":e.reserveSelection,width:"40",align:"center",selectable:e.selecteisDisabled}}):e._e(),e.showIndex?t("el-table-column",{attrs:{fixed:"left",type:"index",label:"序号","min-width":"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.pageSize*(e.currentPage-1)+(t.$index+1))+" ")]}}],null,!1,1067877e3)}):e._e(),e._t("columns")],2),e.$listeners["current-change"]?t("el-pagination",{staticClass:"text-end mt-3",attrs:{"page-sizes":[e.$tableDataSize,20,30,50],"page-size":e.pageSize,disabled:e.total<=0||e.loading,"current-page":e.currentPage,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.dataSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},l=[],i=o(2086),a=o.n(i),r=(o(7658),o(7092)),s=o(9177),c=o.n(s);function d(e=[],t="下载的文件"){e=e.map(((e,t)=>({"序号":t+1,...e})));const o=r.P6.book_new();let n=r.P6.json_to_sheet(e);n=h(n),n["!cols"]=u(e),r.P6.book_append_sheet(o,n);const l=new Blob([g(c().write(o,{bookType:"xlsx",bookSST:!0,type:"binary",cellStyles:!0}))]);p(l,t+".xlsx")}function h(e){const t={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}};for(let o in e){if(["!cols","!ref"].includes(o))continue;e[o].s={border:t,alignment:{vertical:"center",wrapText:!0}};const n=o.replace(/\D/gi,"");"1"===n&&(e[o].s={border:t,font:{bold:!0},fill:{fgColor:{rgb:"CCCCCC"}}})}return e}function u(e){const t=Object.keys(e[0]).map((e=>e?/.*[\u4e00-\u9fa5]+.*$/.test(e)?parseFloat(2.15*e.toString().length):parseFloat(1.15*e.toString().length):10)),o=e.map((e=>{const o=Object.values(e).map(((e,o)=>{let n;return n=e?/.*[\u4e00-\u9fa5]+.*$/.test(e)?parseFloat(2.15*e.toString().length):parseFloat(1.15*e.toString().length):10,Math.max(n,t[o])}));return o}));let n=[];return o.map(((e,t)=>{let o=[];e.map(((e,l)=>{0===t?o.push({wch:e}):o.push({wch:Math.max(e,n[l].wch)})})),n=o})),n}function g(e){if("undefined"!==typeof ArrayBuffer){const t=new ArrayBuffer(e.length),o=new Uint8Array(t);for(let n=0;n<=e.length;++n)o[n]=255&e.charCodeAt(n);return t}{const t=new Array(e.length);for(let o=0;o<=e.length;++o)t[o]=255&e.charCodeAt(o);return t}}function p(e,t){const o=document.createElement("a");o.download=t,"msSaveOrOpenBlob"in navigator?window.navigator.msSaveOrOpenBlob(e,t):o.href=URL.createObjectURL(e),o.click(),setTimeout((()=>{URL.revokeObjectURL(e)}),2e3)}var m={name:"custom-table",components:{"el-table":a()},data(){return{style:{headerCell:{"background-color":"#f5f7fa"}}}},props:{name:{type:String},showIndex:{type:Boolean,default:!1},data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},size:{type:String,default:"small"},emptyText:{type:String},border:{type:Boolean,default:!0},rowKey:{type:[String,Number]},height:{type:[String,Number]},maxHeight:{type:[String,Number]},cellStyle:{type:[Function,Object]},headerCellStyle:{type:[Function,Object]},total:{type:Number,default:0},pageSize:{type:Number,default(){return this.$tableDataSize}},currentPage:{type:Number,default:1},showSummary:{type:Boolean,default:!1},summaryMethod:{type:Function},reserveSelection:{type:Boolean,default:!0},selecteisDisabled:{type:Function},rowClassName:{type:Function},derive:{type:Function,default:null}},watch:{data(e,t){const o=this;this.$nextTick((()=>{o.doLayout()}))}},computed:{showSelection(){return this.$listeners["select"]||this.$listeners["selection-change"]},olyHeight(){return this.height?"height":"max-height"}},activated(){this.doLayout()},methods:{dataSizeChange(e){this.$emit("size-change",e)},handleCurrentChange(e){this.$emit("current-change",e)},select(e,t){this.$emit("select",e,t),this.doLayout()},selectionChange(e){this.$emit("selection-change",e),this.doLayout()},selectAll(e){this.$emit("select-all",e),this.doLayout()},clearSelection(){this.$refs.table.clearSelection(),this.doLayout()},toggleAllSelection(){this.$refs.table.toggleAllSelection(),this.doLayout()},toggleRowSelection(e=[],t=!0){this.$refs.table.toggleRowSelection(e,t),this.doLayout()},setCurrentRow(e){this.$refs.table.setCurrentRow(e),this.doLayout()},rowClick(e,t,o){this.$emit("row-click",e,t,o),this.doLayout()},cellClick(e,t,o,n){this.$emit("cell-click",e,t,o,n),this.doLayout()},rowDblclick(e,t,o){this.$emit("row-dblclick",e,t,o)},exporting(e){if(this.total<1)return this.$message.warning("无数据可导"),!1;"1"===e||"2"===e&&this.total<3e3?this.exportingExcel(e):(this.$message.success("即将打开微信对话，请注意您的微信软件"),window.open("https://work.weixin.qq.com/kfid/kfcbf0a5d334bd9e501","_blank","location=no, status=no, menubar=no")),this.doLayout()},exportingExcel(e){const t=this.name||this.$route.meta.menuName+"表",o="granted"===Notification.permission?new Notification("开始下载",{body:t}):this.$notify.info({title:"开始下载"});this.derive(e).then((e=>{e?(d(e,t),"granted"===Notification.permission?new Notification("下载成功",{body:t}):this.$notify.success({title:"下载成功"})):"granted"===Notification.permission?new Notification("下载失败",{body:t}):this.$notify.error({title:"下载失败"})})).catch((()=>{"granted"===Notification.permission?new Notification("下载失败",{body:t}):this.$notify.error({title:"下载失败"})})).finally((()=>{o.close()}))},printing(e){if(this.total<1)return this.$message.info("无数据打印");this.$emit("printing",e),this.doLayout()},doLayout(){this.$refs.table.doLayout()},getColumns(){let e=[];return function t(o){o.map((o=>{o.$children&&t(o.$children),o.label&&o.prop&&e.push({label:(o.$parent.label||"")+o.label,prop:o.prop})}))}(this.$refs.table.$children),e},exportExcel:d}},f=m,y=o(1001),b=(0,y.Z)(f,n,l,!1,null,"98369738",null),w=b.exports},442:function(){},5792:function(){}}]);