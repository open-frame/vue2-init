(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[1753],{6572:function(t,e,s){"use strict";s.d(e,{I:function(){return n},a:function(){return a}});var o=s(2617);function n(t,e){return o.o.get("/service/demo/loadHomeConfig.json",t,e)}function a(t,e){return o.o.get("/service/demo/newElecUser.json",t,e)}},1753:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return h}});var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"position-relative home"},[t.$route.meta.permissions.length>0&&t.myCards.length>0?e("el-button-group",{directives:[{name:"show",rawName:"v-show",value:t.editLayout,expression:"editLayout"}],staticClass:"animate-bounce-in animate-duration-0.5s position-absolute edit-layout-btns"},[e("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-check"},on:{click:t.okLayout}},[t._v("确认调整")]),e("el-button",{attrs:{size:"mini",icon:"el-icon-close"},on:{click:function(e){t.editLayout=!1}}},[t._v("关闭调整")])],1):t._e(),0===t.$route.meta.permissions.length?e("el-empty",{attrs:{description:"您没有模块权限"}},[e("a",{attrs:{target:"_blank",href:t.VUE_APP_CLW_SERVICE}},[t._v("咨询客服，申请模块权限")])]):t._e(),t.$route.meta.permissions.length>0&&0===t.myCards.length?e("el-empty",{attrs:{description:"您未添加模块展示"}},[e("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addLayout=!0}}},[t._v("添 加")])],1):t._e(),t.$route.meta.permissions.length>0&&t.myCards.length>0?e("div",{staticClass:"panels"},[t._l(t.myCards,(function(s,o){return[e("vue-draggable-resizable",{directives:[{name:"permission",rawName:"v-permission",value:s.permission,expression:"card.permission"}],key:o,attrs:{w:s.w,h:s.h,x:s.x,y:s.y,"min-width":t.vdrConfig.minWidth,"enable-native-drag":!0,draggable:t.editLayout,resizable:t.editLayout},on:{activated:function(e){return t.changeCardItem(s)},resizestop:t.onResizstop,dragstop:t.onDragstop}},[s.error?e("el-result",{staticClass:"bg-white shadow-sm",attrs:{icon:"error",title:"组件加载错误",subTitle:s.name}},[e("a",{attrs:{slot:"extra",target:"_blank",href:t.VUE_APP_CLW_SERVICE},slot:"extra"},[t._v("反馈给客服")])]):e("div",{staticClass:"bg-white shadow-sm module"},[e("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:t.editLayout,expression:"editLayout"}],staticClass:"handle-btns",on:{command:function(e){return t.settings(e,s,o)}}},[e("el-button",{attrs:{plain:"",type:"primary",size:"mini"}},[t._v("操作")]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"0"}},[t._v("删除")])],1)],1),e("router-link",{staticClass:"h5 p-2 m-0 text-black",staticStyle:{display:"inline-block"},attrs:{to:s.url}},[t._v(" "+t._s(s.name)+" ")]),e(s.component,{ref:s.component,refInFor:!0,tag:"component"})],1)],1)]}))],2):t._e(),e("el-dropdown",{attrs:{trigger:"click"},on:{command:t.layoutSetting}},[e("span",{staticClass:"el-icon-s-tools text-2xl"}),e("el-dropdown-menu",{attrs:{slot:"dropdown","append-to-body":!1},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"addLayout"}},[t._v("选择模块")]),e("el-dropdown-item",{attrs:{command:"editLayout"}},[t._v("模块布局")])],1)],1),e("panels-manage",{attrs:{"my-cards":t.myCards,show:t.addLayout},on:{close:function(e){t.addLayout=!1},success:t.editSuccess}})],1)},n=[],a=s(6572),i=s(6867),r=s(844),d=s.n(r),c={name:"home-index",directives:{permission:i.rd},components:{VueDraggableResizable:d(),"panels-manage":()=>s.e(4128).then(s.bind(s,4128))},data(){return{VUE_APP_CLW_SERVICE:"",vdrConfig:{editActive:!1,minWidth:300,tolerance:10,changeCard:{}},myCards:[],editLayout:!1,addLayout:!1}},created(){this.VUE_APP_CLW_SERVICE="https://work.weixin.qq.com/kfid/kfc4fd7cae33c6448f9"},mounted(){this.hasLayout()},methods:{hasLayout(){(0,a.I)().then((t=>{if(0===t.code&&0!==t.data.length){this.myCards=JSON.parse(t.data[0].homeJson);for(let t in this.myCards)try{const e=this.myCards[t].component;this.$options.components[e]=()=>s(7421)(`./${e}`)}catch(e){this.myCards[t].error=!0}}}))},changeCardItem(t){this.editLayout&&(this.vdrConfig.changeCard=t)},onResizstop(t,e,s,o){this.myCards.filter((n=>(this.vdrConfig.changeCard.permission===n.permission&&(n.w=s,n.h=o,n.x=t,n.y=e),!0)))},onDragstop(t,e){this.myCards.map((s=>{this.vdrConfig.changeCard.permission===s.permission&&(s.x=t,s.y=e)}))},settings(t,e,s){switch(t){case"0":this.detelePanel(e,s);break;case"2":break}},detelePanel(t,e){this.myCards.splice(e,1)},okLayout(){(0,a.editHomeLayout)({homeJson:JSON.stringify(this.myCards)}).then((t=>{0===t.code&&(this.hasLayout(),this.editLayout=!1,this.$message.success("调整成功"))}))},editSuccess(t){this.myCards=t,this.hasLayout()},layoutSetting(t){this[t]=!0}},beforeRouteLeave(t,e,s){this.editLayout?this.$confirm("您在调整布局结构",{confirmButtonText:"保存并离开",cancelButtonText:"继续调整",type:"warning"}).then((()=>{this.okLayout(),s()})).catch((()=>{})):s()}},u=c,l=s(1001),m=(0,l.Z)(u,o,n,!1,null,"58970b60",null),h=m.exports},7421:function(t,e,s){var o={"./backlog":[6670,9674,7815,4945,3699,5508,4461,5588,1691,741,6670,7853],"./backlog.vue":[6670,9674,7815,4945,3699,5508,4461,5588,1691,741,6670,7853],"./new-users":[4786,9674,7815,4945,3699,5508,4461,5588,1691,4786,7342],"./new-users.vue":[4786,9674,7815,4945,3699,5508,4461,5588,1691,4786,7342],"./nopay-orders":[9259,9674,7815,4945,3699,5508,4461,5588,1691,741,9259,9124],"./nopay-orders.vue":[9259,9674,7815,4945,3699,5508,4461,5588,1691,741,9259,9124],"./orders-refund":[2897,9674,7815,4945,3699,5508,4461,5588,1691,741,2897,6928],"./orders-refund.vue":[2897,9674,7815,4945,3699,5508,4461,5588,1691,741,2897,6928],"./users-withdraw":[3166,9674,7815,4945,3699,5508,4461,5588,1691,741,3166,4636],"./users-withdraw.vue":[3166,9674,7815,4945,3699,5508,4461,5588,1691,741,3166,4636]};function n(t){if(!s.o(o,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=o[t],n=e[0];return Promise.all(e.slice(1).map(s.e)).then((function(){return s(n)}))}n.keys=function(){return Object.keys(o)},n.id=7421,t.exports=n}}]);