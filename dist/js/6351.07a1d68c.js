"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[6351],{46351:function(s,e,t){t.r(e),t.d(e,{default:function(){return m}});var o=function(){var s=this,e=s._self._c;return e("el-dialog",{attrs:{title:"流程回退","close-on-click-modal":!1,"before-close":s.close,"append-to-body":!0,"modal-append-to-body":!1,visible:s.show}},[e("img",{staticClass:"mb-5",attrs:{src:s.processImg,alt:"流程图",srcset:""}}),e("el-form",{ref:"form-dom",attrs:{model:s.form,rules:s.rules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"回退位置",prop:"sid"}},[e("el-select",{attrs:{filterable:"",clearable:"",size:"medium",placeholder:""},model:{value:s.form.sid,callback:function(e){s.$set(s.form,"sid",e)},expression:"form.sid"}},s._l(s.dropdowns.currentTask,(function(s,t){return e("el-option",{key:t,attrs:{label:s.taskName,value:s.sid}})})),1)],1)],1),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:s.submitForm}},[s._v("确 定")]),e("el-button",{on:{click:s.close}},[s._v("关 闭")])],1)],1)},r=[],a=t(83693),i={name:"",data(){return this.rules=l,{dropdowns:{currentTask:[]},processImg:"",form:{sid:""}}},props:{show:{type:Boolean,default:!1},data:{type:Object,required:!0}},watch:{show(s){s&&(this.openProsess(),this.nowTask())}},methods:{openProsess(s){(0,a.IR)({processInstanceId:this.data.processInstanceId}).then((s=>{const e=new Blob([s]);this.processImg=URL.createObjectURL(e)}))},nowTask(){(0,a.ts)({processDefinitionKey:this.data.processDefinitionKey}).then((s=>{0===s.code&&s.data&&(this.dropdowns.currentTask=s.data)}))},submitForm(){this.$refs["form-dom"].validate((s=>{s&&(0,a.Ww)({taskId:this.data.taskId,...this.form}).then((s=>{0===s.code&&(this.$message.success(s.msg),this.$emit("success"),this.close())}))}))},close(){this.$refs["form-dom"].resetFields(),this.$emit("close",!1),URL.revokeObjectURL(this.processImg),this.processImg=""}}};const l={sid:[{required:!0,message:"请选择要回退到的位置",trigger:"change"}]};var c=i,n=t(1001),d=(0,n.Z)(c,o,r,!1,null,"7c2daf52",null),m=d.exports}}]);