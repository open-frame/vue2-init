"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[5170,4164,36,6734,3501,3399,8562,7504,3158,760,6495,3495,2617,8758],{67499:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var r=a(63598),o=a(90649),i=a(1985),n=a(67539),l=function(){var e=this,t=e._self._c;return t("el-card",{},[t(n.Z,{attrs:{loading:e.tableLoading,btnSpan:14,getData:e.getData,queryReset:e.queryReset}},[t("el-col",{attrs:{span:5}},[t(i.Z,{attrs:{animatLable:"",multiple:"","collapse-tags":""},model:{value:e.queryForm.deptCode,callback:function(t){e.$set(e.queryForm,"deptCode",t)},expression:"queryForm.deptCode"}})],1),t("el-col",{attrs:{span:5}},[t(o.Z,{attrs:{animatLable:"",type:"month",clearable:!1,format:"yyyy年MM月","value-format":"yyyy-MM","picker-options":e.pickerOptions,placeholder:"报表月份"},model:{value:e.queryForm.createTime,callback:function(t){e.$set(e.queryForm,"createTime",t)},expression:"queryForm.createTime"}})],1)],1),t("el-divider"),t(r.Z,{ref:"table",attrs:{name:e.queryForm.createTime+"月度运营报表",loading:e.tableLoading,data:e.tableData,height:"580","row-key":"uuid",total:e.total,"page-size":e.queryForm.pageSize,"current-page":e.queryForm.pageNum,derive:e.exporting},on:{"size-change":e.dataSizeChange,"current-change":e.handleCurrentChange,printing:e.printing},scopedSlots:e._u([{key:"columns",fn:function(){return e._l(e.tableHead,(function(e){return t("el-table-column",{key:e.field,attrs:{"show-overflow-tooltip":"",prop:e.field,label:e.displayName}})}))},proxy:!0}])})],1)},s=[],d=(a(57658),a(5376)),p=a(89176),u=a(30741),m={name:"operational-reports-monthly",mixins:[u.LI,u.I_,u.oA,u.vd],data(){return{organizations:[],pickerOptions:{disabledDate(e){return e.getTime()>Date.now()-864e5}},queryForm:{deptCode:[],createTime:"",pageSize:this.$tableDataSize,pageNum:1},tableLoading:!1,tableHead:[],tableData:[],total:0}},created(){this.getOrganizationTree()},methods:{getOrganizationTree(){(0,d.eL)().then((e=>{this.organizations=e}))},getData(){let e;this.tableData=[];try{e={...this.queryForm,deptCode:this.queryForm.deptCode.join()}}catch(t){e={...this.queryForm,deptCode:[]}}(0,p.f0)(e).then((e=>{0===e.code&&(this.createTableHead(e.rows[0]),this.tableData=e.rows,this.total=e.total)}))},createTableHead(e){this.tableHead=[];const t=Object.keys(e).length-1;for(let a=1;a<=t;a++)a<10&&(a="0"+a),this.tableHead.push({field:a+"月",displayName:a+"月"});this.tableHead.unshift({field:"name",displayName:"名称"})},async exporting(e){let t={...this.queryForm,deptCode:this.queryForm.deptCode.join()};"2"===e&&(t.pageSize=this.total,t.pageNum=1);const a=await(0,p.f0)(t);if(0===a.code){const e=this.$refs.table.getColumns(),t=a.rows.map((t=>{let a=e.map((e=>[e.label,t[e.prop]]));return Object.fromEntries(a)}));return t}},printing(e){let t={...this.queryForm,deptCode:this.queryForm.deptCode.join()};"2"===e&&(t.pageSize=this.total,t.pageNum=1);const r=a(36801);(0,p.f0)(t).then((e=>{r({type:"json",printable:e.rows,scanStyles:!0,header:`<div style="text-align: center">\n                    <h2>月度运营报表</h2>\n                    <p style="margin-bottom: 20px;font-size: 12px;">${this.queryForm.createTime}</p>\n                  </div>`,properties:this.tableHead,style:"@media print{@page {size:landscape}}",gridHeaderStyle:"border: 1px solid #000;text-align:center",gridStyle:"border: 1px solid #000;text-align:center"})}))}}},c=m,h=a(1001),y=(0,h.Z)(c,l,s,!1,null,"874f8de0",null),g=y.exports}}]);