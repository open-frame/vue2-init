"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[8388],{67562:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var r=a(1985),s=a(63598),o=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"addUser-queryForm",attrs:{rules:e.addUserQueryRules,inline:"",model:e.queryForm},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{staticClass:"w-full me-0",attrs:{prop:"phonenumber"}},[t("el-input",{attrs:{autofocus:"",clearable:"",placeholder:"手机号"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData.apply(null,arguments)}},model:{value:e.queryForm.phonenumber,callback:function(t){e.$set(e.queryForm,"phonenumber",t)},expression:"queryForm.phonenumber"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getData},slot:"append"})],1)],1)],1),t(s.Z,{ref:"table",attrs:{loading:e.userTableLoading,total:e.total,data:e.tableData,height:"350","row-key":"userId","page-size":e.queryForm.pageSize,"current-page":e.queryForm.pageNum},on:{select:e.selectingData,"size-change":e.dataSizeChange,"current-change":e.handleCurrentChange},scopedSlots:e._u([{key:"columns",fn:function(){return[t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"姓名",prop:"chineseName"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{clearable:"",size:"mini",placeholder:"必填"},model:{value:a.row.chineseName,callback:function(t){e.$set(a.row,"chineseName",t)},expression:"scope.row.chineseName"}})]}}])}),t("el-table-column",{attrs:{label:"隶属组织",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t(r.Z,{attrs:{size:"mini",placeholder:"必选"},model:{value:a.row.deptCode,callback:function(t){e.$set(a.row,"deptCode",t)},expression:"scope.row.deptCode"}})]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"账号",prop:"userId"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"手机号",prop:"phonenumber"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"余额",prop:"balance"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"积分",prop:"integral"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("transfortext")(t.row.runStatus,e.dropdowns.runStatus))+" ")]}}])})]},proxy:!0}])})],1)},l=[],n=a(5376),u=a(97589),i=a(30741),d=a(90886),c={name:"",mixins:[i.oA],filters:{transfortext:d.h},props:{show:{type:Boolean,default:!1}},data(){return{dropdowns:{runStatus:[]},queryForm:{pageSize:this.$tableDataSize,pageNum:1,phonenumber:""},userTableLoading:!1,addUserQueryRules:p,tableData:[],total:0,addUserFormRules:m,selectedData:[]}},created(){this.getDropdowns()},methods:{getDropdowns(){(0,n.Wl)("3018").then((e=>{0===e.code&&(this.dropdowns.runStatus=e.data)}))},getData(){this.$refs["addUser-queryForm"].validate((e=>{e&&(this.userTableLoading=!0,this.tableData=[],(0,u.PR)(this.queryForm).then((e=>{this.userTableLoading=!1,0===e.total&&this.$message.info(e.msg),0===e.code&&(this.tableData=e.rows,this.total=e.total)})))}))},selectingData(e,t){this.selectedData=e},addUser(){if(0===this.selectedData.length)return this.$message.warning("请选择用户");const e=this.selectedData.some((e=>""===e.chineseName||""===e.deptCode));if(e)return this.$message.warning("存在未填写的用户表单");const t=this.selectedData.map((e=>({chineseName:e.chineseName,deptCode:e.deptCode,userId:e.userId})));(0,u.cn)(t).then((e=>{0===e.code&&(this.$emit("success"),this.$message.success("绑定成功"),this.close())}))},close(){this.tableData=[],this.selectedData=[],this.queryForm.pageNum=1,this.queryForm.phonenumber="",this.$refs["table"].clearSelection(),this.$refs["addUser-queryForm"].resetFields()}}};const p={phonenumber:[{required:!0,message:"必须手机号查询",trigger:"blur"},{pattern:/^[0-9]+$/,message:"只能为数字",trigger:"blur"},{min:7,max:16,message:"长度在 7 到 16 个字符",trigger:"blur"}]},m={chineseName:{required:!0,message:" ",trigger:"blur"},deptCode:{required:!0,message:" ",trigger:"blur"}};var h=c,f=a(1001),b=(0,f.Z)(h,o,l,!1,null,"01f65c0a",null),g=b.exports}}]);