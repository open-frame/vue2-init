"use strict";(self["webpackChunkedo_project"]=self["webpackChunkedo_project"]||[]).push([[4976,4287,9458],{4976:function(e,t,s){s.r(t),s.d(t,{default:function(){return p}});var o=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"停复运审批","close-on-click-modal":!1,"append-to-body":!0,visible:e.show,"before-close":e.close}},[t("div",{staticClass:"mb-4"},[t("div",{staticClass:"fs-6 fw-bold text-start"},[e._v("内容信息")]),t("el-descriptions",{attrs:{size:"small",border:""}},[t("el-descriptions-item",{attrs:{label:"电站编号"}},[e._v(e._s(e.info.stationNo))]),t("el-descriptions-item",{attrs:{label:"电站名称"}},[e._v(e._s(e.info.stationName))]),t("el-descriptions-item",{attrs:{label:"申请类别"}},[e._v(e._s(e._f("CodeTransforText")(e.info.restoreType,e.dropdowns.restoreType)))]),t("el-descriptions-item",{attrs:{label:"申请原因"}},[e._v(e._s(e.info.reason))]),t("el-descriptions-item",{attrs:{label:"申请人"}},[e._v(e._s(e.info.updateBy))]),t("el-descriptions-item",{attrs:{label:"申请时间"}},[e._v(e._s(e.info.createTime))])],1)],1),t("process-info",{ref:"process-info",attrs:{params:e.params}}),e.$listeners.success?t("el-form",{ref:"ruleForm",staticClass:"mt-5",attrs:{model:e.form,rules:e.rules,"label-width":"90px"}},[t("el-form-item",{attrs:{label:"审批结果",prop:"status"}},[t("el-select",{attrs:{filterable:"","default-first-option":"",clearable:"",placeholder:""},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.dropdowns.status,(function(e,s){return t("el-option",{key:s,attrs:{label:e.code_name,value:e.code_value}})})),1)],1),t("el-form-item",{attrs:{label:"审批意见",prop:"comments"}},[t("el-input",{attrs:{clearable:"",placeholder:""},model:{value:e.form.comments,callback:function(t){e.$set(e.form,"comments",t)},expression:"form.comments"}})],1)],1):e._e(),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.$listeners.success?[e.params.assignee?e._e():t("el-button",{attrs:{plain:"",type:"primary"},on:{click:e.entrust}},[e._v("委托办理")]),t("el-button",{attrs:{type:"primary"},on:{click:e.examine}},[e._v("审批")])]:e._e(),t("el-button",{on:{click:e.close}},[e._v("关闭")])],2)],1)},r=[],a=s(6461),n=s(6795),i=s(4287),l={name:"",components:{"process-info":()=>s.e(3145).then(s.bind(s,3145))},filters:{CodeTransforText:i.C},data(){return{dropdowns:{status:[],restoreType:[]},info:{},rules:c,form:{status:"",comments:""}}},props:{show:{type:Boolean,default:!1},params:{type:Object,required:!0}},watch:{show:{immediate:!0,handler(e,t){e&&(this.getDetailInfo(),this.getDropdowns())}}},methods:{getDropdowns(){n.Z.dropdowns("426807").then((e=>{0===e.code&&(this.dropdowns.status=e.data)})),n.Z.dropdowns("3001").then((e=>{0===e.code&&(this.dropdowns.restoreType=e.data)}))},getDetailInfo(){api.examineInfo({procInstId:this.params.processInstanceId}).then((e=>{0===e.code&&(this.info=e.data)}))},entrust(){const e=this.$createElement;let t="";this.$msgbox({title:"选择委托办理人",message:e("div",{key:new Date+""},[e("client-select",{attrs:{key:this.params.taskId},on:{change:e=>{t=e}}})]),confirmButtonText:"确定",beforeClose:(e,s,o)=>{if("confirm"===e){if(!t)return void this.$message.error("请选择委托办理人");s.confirmButtonLoading=!0,s.confirmButtonText="执行中...",a.Z.taskEntrust({assignee:t,taskId:this.params.taskId}).then((e=>{0===e.code&&(o(),this.close(),this.$emit("success"),this.$message.success(e.msg))})).finally((()=>{s.confirmButtonLoading=!1}))}else o()}})},examine(){this.$refs["ruleForm"].validate((e=>{e&&api.stationComplete({...this.form,procInstId:this.params.processInstanceId}).then((e=>{0===e.code&&(this.close(),this.$emit("success"),this.$message.success(e.msg))}))}))},close(){try{this.$refs["ruleForm"].resetFields()}catch(e){}this.$emit("close",!1)}}};const c={status:[{required:!0,message:"请选择审批结果",trigger:"change"}],comments:[{required:!0,message:"请输入审批意见",trigger:"blur"},{pattern:/^[^<|>|-|*|/|=|{|}]*$/,message:"禁止< > - * / = { }等特殊字符",trigger:"blur"}]};var m=l,d=s(1001),u=(0,d.Z)(m,o,r,!1,null,"1e6a138c",null),p=u.exports},4287:function(e,t,s){s.d(t,{C:function(){return o}});s(7658);function o(e,t,s={name:"name",value:"value"}){if(Array.isArray(t),!e)return"";if(!t)return"";const o=e.toString();if(o.includes(",")){let e=[];for(let r of o.split(","))e.push(t.find((e=>e[s.value]===r)));return e.map((e=>e[s.name])).join(",")}{const e=t.find((e=>e[s.value]===o));return e?e[s.name]:o}}}}]);