"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[4659],{4659:function(e,t,o){o.r(t),o.d(t,{default:function(){return g}});var r=o(63598),a=o(71377),l=o(75267),s=o(67539),i=o(9967),n=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"work-order"},[t("el-row",{attrs:{gutter:40}},[t("el-col",{attrs:{span:4}},[t(i.Z,{on:{"node-click":e.organizationsTreeClick}})],1),t("el-col",{attrs:{span:20}},[t(s.Z,{attrs:{loading:e.loading,btnSpan:8,getData:e.getData,queryReset:e.queryReset}},[t("el-col",{attrs:{span:4}},[t(l.Z,{attrs:{clearable:"",size:"medium",placeholder:"工单号"},on:{change:e.pageReset},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData.apply(null,arguments)}},model:{value:e.queryForm.workOrderId,callback:function(t){e.$set(e.queryForm,"workOrderId",t)},expression:"queryForm.workOrderId"}})],1),t("el-col",{attrs:{span:4}},[t(l.Z,{attrs:{clearable:"",size:"medium",placeholder:"电站名"},on:{change:e.pageReset},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData.apply(null,arguments)}},model:{value:e.queryForm.stationName,callback:function(t){e.$set(e.queryForm,"stationName",t)},expression:"queryForm.stationName"}})],1),t("el-col",{attrs:{span:4}},[t(l.Z,{attrs:{clearable:"",size:"medium",placeholder:"设备"},on:{change:e.pageReset},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData.apply(null,arguments)}},model:{value:e.queryForm.stakeName,callback:function(t){e.$set(e.queryForm,"stakeName",t)},expression:"queryForm.stakeName"}})],1),t("el-col",{attrs:{span:4}},[t(a["default"],{attrs:{filterable:"","default-first-option":"",clearable:"",size:"medium",placeholder:"工单状态"},on:{change:e.pageReset},model:{value:e.queryForm.workOrderStatus,callback:function(t){e.$set(e.queryForm,"workOrderStatus",t)},expression:"queryForm.workOrderStatus"}},e._l(e.dropdowns.workOrderStatus,(function(e,o){return t("el-option",{key:o,attrs:{label:e.code_name,value:e.code_value}})})),1)],1)],1),t("el-divider"),t(r.Z,{ref:"table",attrs:{loading:e.loading,total:e.total,data:e.tableData,height:"500","row-key":"orderId","page-size":e.queryForm.pageSize,"current-page":e.queryForm.pageNum},on:{"size-change":e.dataSizeChange,"current-change":e.handleCurrentChange,"selection-change":e.selectingdata},scopedSlots:e._u([{key:"left",fn:function(){return[t("el-button",{attrs:{size:"small",icon:"el-icon-plus"},on:{click:function(t){return e.editing("add")}}},[e._v("新增")]),t("el-button",{attrs:{size:"small",icon:"el-icon-delete"},on:{click:function(t){return e.deleteing("more")}}},[e._v("删除")])]},proxy:!0},{key:"columns",fn:function(){return[t("el-table-column",{attrs:{prop:"creatorName",label:"提交人","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"phonenumber",label:"手机号",width:"120"}}),t("el-table-column",{attrs:{prop:"workOrderId",label:"工单号",width:"160","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"questionDetail",label:"提单描述",width:"360","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"stationName",label:"电站名",width:"160","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"stakeName",label:"设备",width:"160","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"端口",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("transfortext")(t.row.chargePort,e.dropdowns.ports))+" ")]}}])}),t("el-table-column",{attrs:{prop:"creatorRoleName",label:"角色",width:"100","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"createdAt",label:"提单时间",width:"190"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"updaterName",label:"处理人"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"updatedAt",label:"处理时间",width:"190"}}),t("el-table-column",{attrs:{prop:"updatedDetail",label:"处理描述",width:"260","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"workOrderStatusName",label:"工单状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("transfortext")(t.row.workOrderStatus,e.dropdowns.workOrderStatus))+" ")]}}])}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"duration",label:"处理时长"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"overtimeStatus",label:"超时状态"}}),t("el-table-column",{attrs:{label:"操作",width:"160",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(o){return["1"===o.row.dataSrc?t("el-button",{attrs:{plain:"",type:"primary",size:"mini"},on:{click:function(t){return e.editing("detail",o.row)}}},[e._v("详情")]):e._e(),t("el-dropdown",{staticClass:"ms-2",attrs:{trigger:"click"},on:{command:function(t){return e.handling(t,o.row)}}},[t("el-button",{attrs:{size:"mini"}},[e._v(" 更多"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},["1"!==o.row.dataSrc?t("el-dropdown-item",{attrs:{command:"1"}},[e._v("修改")]):e._e(),t("el-dropdown-item",{attrs:{command:"2"}},[e._v("删除")]),t("el-dropdown-item",{attrs:{command:"3"}},[e._v("处理")]),t("el-dropdown-item",{attrs:{command:"4"}},[e._v("历史")])],1)],1)]}}])})]},proxy:!0}])})],1)],1),t("worder",{attrs:{show:e.showEditFormDialogrVisible,dialogText:e.dialogText,data:e.workOrder},on:{close:e.closeEditFormVisible,success:e.getData}}),t("disposeing",{attrs:{show:e.disposeFeedbackVisible,data:e.workOrder},on:{close:e.closeDisposeFeedback,success:e.getData}}),t("dispose-record",{attrs:{show:e.processingRecordVisible,data:e.workOrder},on:{close:e.closeDisposeRecord}})],1)},d=[],c=(o(57658),o(89176)),p=o(90886),u=o(5376),h=o(30741),w={name:"operational-work-order-index",mixins:[h.LI,h.I_,h.Q5,h.oA,h.vd],components:{worder:()=>Promise.all([o.e(4713),o.e(7580)]).then(o.bind(o,88201)),"dispose-record":()=>o.e(5737).then(o.bind(o,35737)),disposeing:()=>o.e(6122).then(o.bind(o,10953))},filters:{transfortext:p.h},data(){return{loading:!1,queryForm:{deptCode:"",workOrderId:"",stationName:"",stakeName:"",workOrderStatus:"",pageSize:this.$tableDataSize,pageNum:1,orderByColumn:"",isAsc:"desc"},tableData:[],total:0,selectDate:[],dropdowns:{yesORno:[],workOrderStatus:[],allPowerStation:[],ports:[]},workOrder:{},dialogText:"",disposeFeedbackVisible:!1,processingRecordVisible:!1,processingRecord:[]}},created(){this.getDropdowns()},methods:{getDropdowns(){(0,u.Wl)("3019").then((e=>{0===e.code&&(this.dropdowns.workOrderStatus=e.data)})),(0,u.Wl)("3010").then((e=>{0===e.code&&(this.dropdowns.ports=e.data)}))},organizationsTreeClick(e){this.queryForm.deptCode=e.deptCode,this.getData()},getData(){this.tableData=[],this.loading=!0,(0,c.Ir)(this.queryForm).then((e=>{this.loading=!1,0===e.code&&(this.total=e.total,this.tableData=e.rows)})).catch((()=>{this.loading=!1}))},selectingdata(e){this.selectDate=e},editing(e,t){switch(this.showEditFormDialogrVisible=!0,this.workOrder={...t},e){case"add":this.dialogText="添加工单";break;case"detail":this.dialogText="工单详情";break;case"modification":this.dialogText="修改工单";break}},closeEditFormVisible(e){this.showEditFormDialogrVisible=e,this.workOrder={}},handling(e,t){switch(e){case"1":this.editing("modification",t);break;case"2":this.deleteing("one",t);break;case"3":this.openPisposePanel(t);break;case"4":this.resultHandling(t);break}},deleteing(e,t){if("more"===e&&this.selectDate.length<1)return this.$message.warning("请选择删除项"),!1;this.$confirm("一旦删除不可恢复，确定删除？","删除提醒",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"放弃"}).then((()=>{let o=[];if("one"===e)o.push(t.id);else{o=[];for(let e of this.selectDate)o.push(e.id)}(0,c.Aj)({workOrderIds:o}).then((e=>{0===e.code&&(this.$message.success("删除成功"),this.getData(),this.selectDate=[])}))})).catch((()=>{}))},openPisposePanel(e){this.disposeFeedbackVisible=!0,this.workOrder={...e}},closeDisposeFeedback(e){this.disposeFeedbackVisible=e,this.workOrder={}},resultHandling(e){this.processingRecordVisible=!0,this.workOrder={...e}},closeDisposeRecord(e){this.processingRecordVisible=e,this.workOrder={}}}},m=w,b=o(1001),k=(0,b.Z)(m,n,d,!1,null,"4d4a67af",null),g=k.exports}}]);