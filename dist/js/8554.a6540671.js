"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[8554],{78554:function(e,t,o){o.r(t),o.d(t,{default:function(){return k}});var a=o(63598),l=o(71377),s=o(1985),r=o(66654),n=o(75267),i=o(12025),u=o(67539),c=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"station"},[t(u.Z,{attrs:{loading:e.tableLoading,btnSpan:8,getData:e.getData,queryReset:e.queryReset}},[t("el-col",{attrs:{span:4}},[t(n.Z,{attrs:{clearable:"",size:"medium",placeholder:"设备名称"},on:{change:e.pageReset},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData.apply(null,arguments)}},model:{value:e.queryForm.stakeName,callback:function(t){e.$set(e.queryForm,"stakeName",t)},expression:"queryForm.stakeName"}})],1),t("el-col",{attrs:{span:4}},[t(n.Z,{attrs:{clearable:"",size:"medium",placeholder:"设备编号"},on:{change:e.pageReset},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData.apply(null,arguments)}},model:{value:e.queryForm.stakeNo,callback:function(t){e.$set(e.queryForm,"stakeNo",t)},expression:"queryForm.stakeNo"}})],1),t("el-col",{attrs:{span:4}},[t(l["default"],{attrs:{filterable:"","default-first-option":"",clearable:"",size:"medium",placeholder:"设备型号"},on:{change:e.pageReset},model:{value:e.queryForm.equipModel,callback:function(t){e.$set(e.queryForm,"equipModel",t)},expression:"queryForm.equipModel"}},e._l(e.dropdowns.equipModel,(function(e,o){return t("el-option",{key:o,attrs:{label:e.code_name,value:e.code_value}})})),1)],1),t("el-col",{attrs:{span:4}},[t(i.Z,{attrs:{animatLable:"",placeholder:"归属电站"},on:{change:e.pageReset},model:{value:e.queryForm.stationNo,callback:function(t){e.$set(e.queryForm,"stationNo",t)},expression:"queryForm.stationNo"}})],1),t("el-col",{attrs:{span:4}},[t(n.Z,{attrs:{clearable:"",size:"medium",placeholder:"电站名称"},on:{change:e.pageReset},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData.apply(null,arguments)}},model:{value:e.queryForm.stationName,callback:function(t){e.$set(e.queryForm,"stationName",t)},expression:"queryForm.stationName"}})],1),t("el-col",{attrs:{span:4}},[t(n.Z,{attrs:{clearable:"",size:"medium",placeholder:"SIM卡号"},on:{change:e.pageReset},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData.apply(null,arguments)}},model:{value:e.queryForm.simNo,callback:function(t){e.$set(e.queryForm,"simNo",t)},expression:"queryForm.simNo"}})],1),t("el-col",{attrs:{span:4}},[t(r.Z,{attrs:{animatLable:""},model:{value:e.queryForm.constructionUuid,callback:function(t){e.$set(e.queryForm,"constructionUuid",t)},expression:"queryForm.constructionUuid"}})],1),t("el-col",{attrs:{span:4}},[t(l["default"],{attrs:{filterable:"","default-first-option":"",clearable:"",size:"medium",placeholder:"使用状态"},model:{value:e.queryForm.switchStatus,callback:function(t){e.$set(e.queryForm,"switchStatus",t)},expression:"queryForm.switchStatus"}},e._l(e.dropdowns.switchStatus,(function(e,o){return t("el-option",{key:o,attrs:{label:e.code_name,value:e.code_value}})})),1)],1),t("el-col",{attrs:{span:4}},[t(s.Z,{attrs:{animatLable:"","collapse-tags":""},model:{value:e.queryForm.deptCode,callback:function(t){e.$set(e.queryForm,"deptCode",t)},expression:"queryForm.deptCode"}})],1),t("el-col",{attrs:{span:4}},[t(l["default"],{attrs:{filterable:"","default-first-option":"",clearable:"",size:"medium",placeholder:"网络状态"},model:{value:e.queryForm.status,callback:function(t){e.$set(e.queryForm,"status",t)},expression:"queryForm.status"}},e._l(e.dropdowns.deviceState,(function(e,o){return t("el-option",{key:o,attrs:{label:e.code_name,value:e.code_value}})})),1)],1)],1),t("el-divider"),t(a.Z,{ref:"table",attrs:{loading:e.tableLoading,total:e.total,data:e.tableData,height:"480","row-key":"stakeNo",derive:e.exporting,"page-size":e.queryForm.pageSize,"current-page":e.queryForm.pageNum},on:{"selection-change":e.selectingData,"size-change":e.dataSizeChange,"current-change":e.handleCurrentChange},scopedSlots:e._u([{key:"left",fn:function(){return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"function_async",expression:"'function_async'"}],attrs:{size:"small",icon:"el-icon-sort",loading:e.asyncLoad},on:{click:e.asyncing}},[e._v("同步")]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"function_reset",expression:"'function_reset'"}],attrs:{size:"small",icon:"el-icon-refresh"},on:{click:function(t){return e.restart("more")}}},[e._v("重启")])]},proxy:!0},{key:"columns",fn:function(){return[t("el-table-column",{attrs:{prop:"stationName",width:"180","show-overflow-tooltip":"",label:"所属站"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"stakeNo",label:"设备编号"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"stakeName",label:"设备名称"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"address",label:"站地址"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"equipModelUuid",label:"型号"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"version",label:"版本"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"simSignal",label:"信号"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"temperature",label:"温度"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"simNo",label:"SIM卡"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"realPower",label:"功率"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"acCurA",label:"电流"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"orderId",label:"当前订单"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"sysTime",label:"设备时钟"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"statusTime",label:"更新时间"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"status",label:"网络状态"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"switchStatus",label:"使用状态"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"stopStatus",label:"故障状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s("1"===t.row.stopStatus?"急停":"")+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"function_reset",expression:"'function_reset'"}],attrs:{plain:"",type:"warning",size:"mini"},on:{click:function(t){return e.restart("one",o.row)}}},[e._v("重启")])]}}])})]},proxy:!0}])})],1)},p=[],d=o(89176),m=o(74713),h=o(5376),f=o(30741),y=o(86867),b={name:"operational-runing-index",mixins:[f.LI,f.I_,f.oA,f.vd],directives:{permission:y.rd},data(){return{worker:null,tableLoading:!1,dropdowns:{switchStatus:[],deviceState:[],stations:[],equipModel:[]},queryForm:{stakeNo:"",stakeName:"",equipModel:"",stationNo:"",device:"",deptCode:"",simNo:"",constructionUuid:"",switchStatus:"",status:"",stationName:"",pageSize:this.$tableDataSize,pageNum:1,orderByColumn:"status",isAsc:"desc"},tableData:[],selectedDate:[],total:0,asyncLoad:!1}},created(){this.getDropdowns()},methods:{getDropdowns(){(0,h.Wl)("3031").then((e=>{0===e.code&&(this.dropdowns.switchStatus=e.data)})),(0,h.Wl)("1038").then((e=>{0===e.code&&(this.dropdowns.deviceState=e.data)})),(0,h.Wl)("3005").then((e=>{0===e.code&&(this.dropdowns.equipModel=e.data)})),(0,m.NK)({s:""}).then((e=>{this.dropdowns.stations=e.data}))},getData(){this.tableData=[],this.tableLoading=!0,(0,d.qC)(this.queryForm).then((e=>{this.tableLoading=!1,0===e.code&&(this.tableData=e.rows,this.total=e.total)})).catch((()=>{this.tableLoading=!1}))},selectingData(e){this.selectedDate=e},restart(e,t){return"more"===e&&0===this.selectedDate.length?(this.$message.warning("请选择重启的设备"),!1):"more"===e&&this.selectedDate.length>50?(this.$message.warning("最多 50 个"),!1):void this.$confirm("确定重启设备？","提示",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"放弃"}).then((()=>{let o=[];o="one"===e?[t.stakeNo]:this.selectedDate.map((e=>e.stakeNo)),(0,d.j_)(o).then((e=>{0===e.code&&(this.$message.info("开始重启设备..."),this.$refs["table"].clearSelection())}))})).catch((()=>{}))},asyncing(){this.$confirm("确定同步设备？","提示",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"放弃"}).then((()=>{this.asyncLoad=!0,(0,d.oW)({constructionUuid:this.queryForm.constructionUuid}).then((e=>{this.asyncLoad=!1,0===e.code&&(this.getData(),this.$message.success("同步成功"))})).catch((()=>{this.asyncLoad=!1}))})).catch((()=>{}))},async exporting(e){let t={...this.queryForm};"2"===e&&(t.pageSize=this.total,t.pageNum=1);const o=await(0,d.qC)(t);if(0===o.code){const e=this.$refs.table.getColumns(),t=o.rows.map((t=>{let o=e.map((e=>[e.label,t[e.prop]]));return Object.fromEntries(o)}));return t}}}},w=b,g=o(1001),v=(0,g.Z)(w,c,p,!1,null,"880caf5e",null),k=v.exports}}]);