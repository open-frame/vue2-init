"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[4917],{34917:function(e,t,o){o.r(t),o.d(t,{default:function(){return b}});var a=o(63598),s=o(79685),r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{"close-on-click-modal":!1,title:"返厂设备","append-to-body":!0,"before-close":e.close,"modal-append-to-body":!1,visible:e.show}},[t(s.Z,{ref:"selecte-device-table",attrs:{show:"1"===e.type},on:{change:e.selectionDevice}}),"0"===e.type?t(a.Z,{ref:"table",attrs:{data:e.tableData,"max-height":"380","row-key":"stakeNo",total:e.total,"page-size":e.queryForm.pageSize,"current-page":e.queryForm.pageNum},on:{"size-change":e.dataSizeChange,"current-change":e.handleCurrentChange},scopedSlots:e._u([{key:"columns",fn:function(){return[t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"stakeNo",label:"设备编号"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"stakeName",label:"设备名称"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"type",label:"设备类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("transfortext")(t.row.type,e.dropdowns.typeCode))+" ")]}}],null,!1,3800378495)}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"modelCode",label:"设备型号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("transfortext")(t.row.equipModelUuid,e.dropdowns.modelCode))+" ")]}}],null,!1,635954922)}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"rcvReturnDate",label:"出库时间"}})]},proxy:!0}],null,!1,873684260)}):e._e(),t("el-divider"),t("el-form",{ref:"backDeviceForm",attrs:{model:e.backDeviceForm,"label-width":"95px"}},[t("el-form-item",{attrs:{label:"返厂说明",prop:"ioWhReason",rules:[{required:!0,message:"请输入返厂说明",trigger:"blur"},{pattern:/^[^<|>|-|*|/|=|{|}]*$/,message:"禁止< > - * / = { }等特殊字符",trigger:"blur"},{min:3,max:48,message:"长度在 3 到 48 个字符",trigger:"blur"}]}},[t("el-input",{attrs:{clearable:"",type:"textarea",readonly:"1"!==e.type},model:{value:e.backDeviceForm.ioWhReason,callback:function(t){e.$set(e.backDeviceForm,"ioWhReason",t)},expression:"backDeviceForm.ioWhReason"}})],1)],1),t("span",{attrs:{slot:"footer"},slot:"footer"},["1"===e.type?t("el-button",{attrs:{type:"primary"},on:{click:e.backing}},[e._v("返厂")]):e._e(),t("el-button",{on:{click:e.close}},[e._v("关闭")])],1)],1)},l=[],i=o(74713),n=o(5376),c=o(30741),d=o(90886),p={name:"property-supplier-index",mixins:[c.oA],components:{selecteDeviceTable:s.Z},filters:{transfortext:d.h},data(){return{tableLoading:!1,dropdowns:{typeCode:[],modelCode:[]},queryForm:{ioWhId:"",whNo:"",typeCode:"",modelCode:"",pageSize:this.$tableDataSize,pageNum:1},tableData:[],total:0,selectData:[],backDeviceForm:{typeCode:"",ioWhReason:"",whNo:"",merchantNo:"",stakes:[]}}},props:{show:{type:Boolean,default:!1},type:{type:String,default:""},data:{type:Object,default(){return{}}}},watch:{show(e){if(e){this.getDropdowns(),this.queryForm.pageNum=1;const e=this;this.$nextTick((()=>{e.data.ioWhReason&&(e.backDeviceForm.ioWhReason=e.data.ioWhReason)}))}},type(e){"0"===e&&this.getData()}},methods:{getData(){this.tableData=[],this.tableLoading=!0,(0,i.oA)(this.queryForm).then((e=>{this.tableLoading=!1,0===e.code&&(this.tableData=e.rows,this.total=e.total)})).catch((()=>{this.tableLoading=!1}))},getDropdowns(){(0,n.Wl)("3004").then((e=>{0===e.code&&(this.dropdowns.typeCode=e.data)})),(0,n.Wl)("3005").then((e=>{0===e.code&&(this.dropdowns.modelCode=e.data)}))},selectionDevice(e,t){this.backDeviceForm.stakes=e,this.backDeviceForm.typeCode=t.typeCode,this.backDeviceForm.whNo=t.whNo},backing(){if(this.backDeviceForm.stakes.length<1)return this.$message.error("请筛选出设备，选择返厂设备");this.$refs["backDeviceForm"].validate((e=>{e&&(0,i.Mo)(this.backDeviceForm).then((e=>{0===e.code&&(this.$emit("success",{}),this.$message.success(e.msg),this.close())}))}))},close(){this.$emit("close",!1),this.$refs["backDeviceForm"].resetFields();try{this.$refs["selecte-device-table"].resetFields()}catch(e){}}}},h=p,u=o(1001),m=(0,u.Z)(h,r,l,!1,null,"04dc38ad",null),b=m.exports}}]);