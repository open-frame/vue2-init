"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[7157],{7157:function(e,t,o){o.r(t),o.d(t,{default:function(){return h}});var a=o(63598),r=o(71377),l=o(75267),s=o(67539),i=function(){var e=this,t=e._self._c;return t("el-card",{staticClass:"users-feedbck"},[t(s.Z,{attrs:{loading:e.loading,getData:e.getData,queryReset:e.queryReset}},[t("el-col",{attrs:{span:4}},[t(l.Z,{attrs:{clearable:"",size:"medium",placeholder:"反馈人"},on:{change:e.pageReset},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData.apply(null,arguments)}},model:{value:e.queryForm.creatorName,callback:function(t){e.$set(e.queryForm,"creatorName",t)},expression:"queryForm.creatorName"}})],1),t("el-col",{attrs:{span:4}},[t(l.Z,{attrs:{clearable:"",size:"medium",placeholder:"反馈人账号"},on:{change:e.pageReset},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData.apply(null,arguments)}},model:{value:e.queryForm.loginName,callback:function(t){e.$set(e.queryForm,"loginName",t)},expression:"queryForm.loginName"}})],1),t("el-col",{attrs:{span:4}},[t(l.Z,{attrs:{clearable:"",size:"medium",placeholder:"问题描述"},on:{change:e.pageReset},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData.apply(null,arguments)}},model:{value:e.queryForm.questionDetail,callback:function(t){e.$set(e.queryForm,"questionDetail",t)},expression:"queryForm.questionDetail"}})],1),t("el-col",{attrs:{span:4}},[t(r["default"],{attrs:{filterable:"","default-first-option":"",clearable:"",size:"medium",placeholder:"反馈人类型"},on:{change:e.pageReset},model:{value:e.queryForm.creatorRoleName,callback:function(t){e.$set(e.queryForm,"creatorRoleName",t)},expression:"queryForm.creatorRoleName"}},e._l(e.dropdowns.role,(function(e,o){return t("el-option",{key:o,attrs:{label:e.code_name,value:e.code_value}})})),1)],1),t("el-col",{attrs:{span:4}},[t(r["default"],{attrs:{filterable:"","default-first-option":"",clearable:"",size:"medium",placeholder:"处理状态"},on:{change:e.pageReset},model:{value:e.queryForm.workOrderStatus,callback:function(t){e.$set(e.queryForm,"workOrderStatus",t)},expression:"queryForm.workOrderStatus"}},e._l(e.dropdowns.type,(function(e,o){return t("el-option",{key:o,attrs:{label:e.code_name,value:e.code_value}})})),1)],1)],1),t("el-divider"),t(a.Z,{ref:"table",attrs:{loading:e.loading,total:e.total,data:e.tableData,height:"500","row-key":"orderId","page-size":e.queryForm.pageSize,"current-page":e.queryForm.pageNum,derive:e.exporting},on:{"size-change":e.dataSizeChange,"current-change":e.handleCurrentChange,"selection-change":e.selection},scopedSlots:e._u([{key:"columns",fn:function(){return[t("el-table-column",{attrs:{prop:"creator_name",label:"反馈人",width:"100","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{prop:"login_name",label:"账号",width:"160","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"phonenumber",label:"手机号",width:"120"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("router-link",{staticClass:"text-black",attrs:{to:{name:"management-use-electric-index",params:{phonenumber:o.row.phonenumber}}}},[e._v(" "+e._s(o.row.phonenumber)+" ")])]}}])}),t("el-table-column",{attrs:{prop:"question_detail",label:"问题描述","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"created_at",label:"反馈时间",width:"180"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"updater_name",label:"处理人",width:"150"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"updated_at",label:"处理时间",width:"180"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"workOrderStatus",label:"处理状态",width:"100"}}),t("el-table-column",{attrs:{label:"操作",width:"160",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.seeDetail(o.row)}}},[e._v("详情")]),t("el-dropdown",{staticClass:"ms-2",attrs:{trigger:"click"},on:{command:function(t){return e.handling(t,o.row)}}},[t("el-button",{attrs:{size:"mini"}},[e._v(" 更多"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"openPisposePanel"}},[e._v("处理")]),t("el-dropdown-item",{attrs:{command:"resultHandling"}},[e._v("历史")])],1)],1)]}}])})]},proxy:!0}])}),t("el-dialog",{attrs:{"close-on-click-modal":!1,"append-to-body":!0,"modal-append-to-body":!1,title:"反馈详情",visible:e.feedBackDetailVisible,"show-close":!1}},[t("el-form",{ref:"form",attrs:{model:e.feedBackForm,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"提交人"}},[t("el-input",{attrs:{readonly:!0},model:{value:e.feedBackForm.creator_name,callback:function(t){e.$set(e.feedBackForm,"creator_name",t)},expression:"feedBackForm.creator_name"}})],1),t("el-form-item",{attrs:{label:"反馈时间"}},[t("el-input",{attrs:{readonly:!0},model:{value:e.feedBackForm.created_at,callback:function(t){e.$set(e.feedBackForm,"created_at",t)},expression:"feedBackForm.created_at"}})],1),t("el-form-item",{attrs:{label:"提交账号"}},[t("el-input",{attrs:{readonly:!0},model:{value:e.feedBackForm.login_name,callback:function(t){e.$set(e.feedBackForm,"login_name",t)},expression:"feedBackForm.login_name"}})],1),t("el-form-item",{attrs:{label:"提交人电话"}},[t("el-input",{attrs:{readonly:!0},model:{value:e.feedBackForm.phonenumber,callback:function(t){e.$set(e.feedBackForm,"phonenumber",t)},expression:"feedBackForm.phonenumber"}})],1),t("el-form-item",{attrs:{label:"处理状态"}},[t("el-input",{attrs:{readonly:!0},model:{value:e.feedBackForm.workOrderStatus,callback:function(t){e.$set(e.feedBackForm,"workOrderStatus",t)},expression:"feedBackForm.workOrderStatus"}})],1),t("el-form-item",{attrs:{label:"处理时间"}},[t("el-input",{attrs:{readonly:!0},model:{value:e.feedBackForm.updated_at,callback:function(t){e.$set(e.feedBackForm,"updated_at",t)},expression:"feedBackForm.updated_at"}})],1),t("el-form-item",{attrs:{label:"处理人"}},[t("el-input",{attrs:{readonly:!0},model:{value:e.feedBackForm.updater_name,callback:function(t){e.$set(e.feedBackForm,"updater_name",t)},expression:"feedBackForm.updater_name"}})],1),t("el-form-item",{attrs:{label:"反馈详情"}},[t("el-input",{attrs:{type:"textarea",rows:4,readonly:!0},model:{value:e.feedBackForm.question_detail,callback:function(t){e.$set(e.feedBackForm,"question_detail",t)},expression:"feedBackForm.question_detail"}})],1)],1),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.feedBackDetailVisible=!1}}},[e._v("知道了")])],1)],1),t("el-dialog",{attrs:{"close-on-click-modal":!1,"append-to-body":!0,"modal-append-to-body":!1,title:"处理反馈",visible:e.disposeFeedbackVisible,"show-close":!1}},[t("el-form",{ref:"disposeForm",attrs:{model:e.disposeForm,rules:e.disposeRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"处理状态：",prop:"operatorResult"}},[t("el-select",{attrs:{filterable:"","default-first-option":"",clearable:"",placeholder:"请选择处理处理状态"},model:{value:e.disposeForm.operatorResult,callback:function(t){e.$set(e.disposeForm,"operatorResult",t)},expression:"disposeForm.operatorResult"}},[t("el-option",{attrs:{label:"处理中",value:"2"}}),t("el-option",{attrs:{label:"处理完成",value:"4"}})],1)],1),t("el-form-item",{attrs:{label:"处理描述：",prop:"msgDetail"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入处理描述"},model:{value:e.disposeForm.msgDetail,callback:function(t){e.$set(e.disposeForm,"msgDetail",t)},expression:"disposeForm.msgDetail"}})],1)],1),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeDisposeFeedback}},[e._v("关 闭")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dispose("disposeForm")}}},[e._v("处 理")])],1)],1),t("el-dialog",{attrs:{"close-on-click-modal":!1,"append-to-body":!0,"modal-append-to-body":!1,title:"处理记录",visible:e.processingRecordVisible,"show-close":!1}},[t(a.Z,{ref:"invoiceByOrders-table",attrs:{size:"mini",data:e.processingRecord},scopedSlots:e._u([{key:"columns",fn:function(){return[t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"userName",label:"处理人",width:"150"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"operationTime",label:"处理时间",width:"150"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"msgDetail",label:"处理反馈"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"operatorResult",label:"处理状态"}})]},proxy:!0}])}),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.processingRecordVisible=!1}}},[e._v("知道了")])],1)],1)],1)},n=[],d=o(89176),c=o(5376),p=o(30741),u={name:"operational-users-feedbck-index",mixins:[p.LI,p.I_,p.oA,p.vd],data(){return this.disposeRules=m,{loading:!1,queryForm:{creatorName:"",loginName:"",questionDetail:"",creatorRoleName:"",workOrderStatus:"",pageSize:this.$tableDataSize,pageNum:1},dropdowns:{role:[],type:[]},tableData:[],total:0,selectData:[],processingRecordVisible:!1,processingRecord:[],feedBackDetailVisible:!1,disposeFeedbackVisible:!1,disposeForm:{workOrderId:"",operatorResult:"",msgDetail:""},feedBackForm:{}}},created(){this.getDropdowns()},methods:{getDropdowns(){(0,c.Wl)("3017").then((e=>{0===e.code&&(this.dropdowns.role=e.data)})),(0,c.Wl)("3019").then((e=>{0===e.code&&(this.dropdowns.type=e.data,this.dropdowns.type.splice(2,1))}))},getData(){this.tableData=[],this.loading=!0,(0,d.ht)(this.queryForm).then((e=>{this.loading=!1,this.tableData=e.rows,this.total=e.total})).catch((()=>{this.loading=!1}))},selection(e){this.selectData=e},resultHandling(e){this.processingRecordVisible=!0,(0,d.qp)({workOrderId:e.work_order_id}).then((e=>{this.processingRecord=e.rows}))},seeDetail(e){this.feedBackDetailVisible=!0,this.feedBackForm=e},openPisposePanel(e){this.disposeFeedbackVisible=!0,this.disposeForm.workOrderId=e.work_order_id},closeDisposeFeedback(){this.disposeFeedbackVisible=!1,this.$refs["disposeForm"].resetFields()},handling(e,t){this[e](t)},dispose(e){this.$refs[e].validate((e=>{if(!e)return!1;(0,d.xb)(this.disposeForm).then((e=>{0===e.code?(this.$message.success("处理成功"),this.closeDisposeFeedback(),this.getData()):this.$message.success(e.msg)}))}))},async exporting(e){let t={...this.queryForm};"2"===e&&(t.pageSize=this.total,t.pageNum=1);const o=await(0,d.ht)(t);if(0===o.code){const e=this.$refs.table.getColumns(),t=o.rows.map((t=>{let o=e.map((e=>[e.label,t[e.prop]]));return Object.fromEntries(o)}));return t}}}};const m={operatorResult:[{required:!0,message:"请选择处理处理状态",trigger:"change"}],msgDetail:[{required:!0,message:"请输入处理描述",trigger:"blur"},{pattern:/^[^<|>|(|)|+|-|*|/|%|=|{|}]*$/,message:"禁止< > ( ) + - * / % = { }等特殊字符",trigger:"blur"},{min:2,max:128,message:"长度在 2 到 128 个字符",trigger:"blur"}]};var f=u,b=o(1001),k=(0,b.Z)(f,i,n,!1,null,"7f42e6e0",null),h=k.exports}}]);