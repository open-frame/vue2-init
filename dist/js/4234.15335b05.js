"use strict";(self["webpackChunkiov_platform"]=self["webpackChunkiov_platform"]||[]).push([[4234],{54234:function(e,t,o){o.r(t),o.d(t,{default:function(){return v}});var r=o(63598),a=o(90649),l=o(71377),n=o(12025),s=o(66654),u=o(75267),i=o(67539),c=function(){var e=this,t=e._self._c;return t("div",[t(i.Z,{attrs:{loading:e.loading,getData:e.getData,queryReset:e.queryReset}},[t("el-col",{attrs:{span:4}},[t(u.Z,{attrs:{clearable:"",size:"medium",placeholder:"用户手机号"},on:{change:e.pageReset},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData.apply(null,arguments)}},model:{value:e.queryForm.phoneNumber,callback:function(t){e.$set(e.queryForm,"phoneNumber",t)},expression:"queryForm.phoneNumber"}})],1),t("el-col",{attrs:{span:4}},[t(s.Z,{attrs:{animatLable:"",placeholder:"隶属区域"},on:{change:e.pageReset},model:{value:e.queryForm.constructionUuid,callback:function(t){e.$set(e.queryForm,"constructionUuid",t)},expression:"queryForm.constructionUuid"}})],1),t("el-col",{attrs:{span:4}},[t(n.Z,{attrs:{animatLable:"",placeholder:"归属电站"},on:{change:e.pageReset},model:{value:e.queryForm.stationId,callback:function(t){e.$set(e.queryForm,"stationId",t)},expression:"queryForm.stationId"}})],1),t("el-col",{attrs:{span:4}},[t(l["default"],{attrs:{filterable:"","default-first-option":"",clearable:"",size:"medium",placeholder:"异常原因"},on:{change:e.pageReset},model:{value:e.queryForm.execNum,callback:function(t){e.$set(e.queryForm,"execNum",t)},expression:"queryForm.execNum"}},e._l(e.dropdowns.execNum,(function(e,o){return t("el-option",{key:o,attrs:{label:e.code_name,value:e.code_value}})})),1)],1),t("el-col",{attrs:{span:4}},[t(a.Z,{attrs:{size:"medium",type:"datetimerange",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"订单时间","picker-options":e.pickerOptions},on:{change:e.pageReset},model:{value:e.queryForm.orderSection,callback:function(t){e.$set(e.queryForm,"orderSection",t)},expression:"queryForm.orderSection"}})],1)],1),t("el-divider"),t(r.Z,{ref:"table",attrs:{loading:e.loading,total:e.total,data:e.tableData,height:"560","row-key":"userId","page-size":e.queryForm.pageSize,"current-page":e.queryForm.pageNum},on:{"current-change":e.handleCurrentChange,"size-change":e.dataSizeChange},scopedSlots:e._u([{key:"columns",fn:function(){return[t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"userId",label:"账号"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"手机号",width:"120"},scopedSlots:e._u([{key:"default",fn:function(o){return[t("router-link",{staticClass:"text-black",attrs:{to:{name:"management-use-electric-index",params:{phonenumber:o.row.phoneNumber}}}},[e._v(" "+e._s(o.row.phoneNumber)+" ")])]}}])}),t("el-table-column",{attrs:{prop:"stationName",label:"所属站","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"stationNo",label:"站编号"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"construction",label:"隶属区域"}}),t("el-table-column",{attrs:{"show-overflow-tooltip":"","header-align":"center",label:"异常原因"}},[e._l(e.dropdowns.execNum,(function(o){return t("el-table-column",{key:o.code_value,attrs:{"show-overflow-tooltip":"",prop:o.code_value,label:o.code_name},scopedSlots:e._u([{key:"default",fn:function(r){return t("div",{on:{click:function(t){return e.openAbnormalOrder(o.code_value,r.row)}}},[e._v(" "+e._s(r.row[o.code_value])+" ")])}}],null,!0)})})),t("el-table-column",{attrs:{"show-overflow-tooltip":"",label:"合计"},scopedSlots:e._u([{key:"default",fn:function(o){return t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.openAbnormalOrder("",o.row)}}},[e._v(" "+e._s(e._f("anomalyTotal")(o.row,e.that))+" ")])}}])})],2)]},proxy:!0}])}),t("abnormalOrder",{attrs:{show:e.drawer,"row-key":"userId",queryForm:e.abnormalOrderQueryForm},on:{close:e.closeAbnormalOrder}})],1)},d=[],m=o(30741),p=o(19596),h=o(5376),b=o(90886),y={name:"abnormal-index",mixins:[m.I_,m.LI,m.oA],filters:{transfortext:b.h,anomalyTotal(e,t){let o=0;for(let r of t.dropdowns.execNum)o+=e[r.code_value];return o}},components:{abnormalOrder:()=>o.e(9162).then(o.bind(o,69162))},data(){return{that:this,pickerOptions:{disabledDate(e){return e.getTime()>Date.now()}},dropdowns:{execNum:[]},loading:!1,queryForm:{exceType:"0",phoneNumber:"",constructionUuid:"",stationNo:"",orderSection:[],execNum:"",startTimeSerach:"",endTimeSerach:"",pageSize:this.$tableDataSize,pageNum:1},tableData:[],total:0,drawer:!1,abnormalOrderQueryForm:{}}},created(){this.getData(),this.getDropdowns()},watch:{"queryForm.orderSection"(e){e?(this.queryForm.startTimeSerach=e[0],this.queryForm.endTimeSerach=e[1]):(this.queryForm.startTimeSerach="",this.queryForm.endTimeSerach="")}},methods:{getDropdowns(){(0,h.Wl)("63005").then((e=>{0===e.code&&(this.dropdowns.execNum=e.data)}))},getData(){this.tableData=[],this.loading=!0,(0,p.eQ)(this.queryForm).then((e=>{this.loading=!1,0===e.code&&(this.total=e.total,this.tableData=e.rows)})).catch((()=>{this.loading=!1}))},openAbnormalOrder(e,t){this.abnormalOrderQueryForm={...this.queryForm,...t,pageSize:this.$tableDataSize,pageNum:1,execNum:e},this.drawer=!0},closeAbnormalOrder(e){this.drawer=e}}},f=y,g=o(1001),w=(0,g.Z)(f,c,d,!1,null,"bd96b062",null),v=w.exports}}]);